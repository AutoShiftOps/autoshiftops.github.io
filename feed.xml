<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://autoshiftops.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://autoshiftops.com/" rel="alternate" type="text/html" /><updated>2026-02-15T12:20:51+00:00</updated><id>https://autoshiftops.com/feed.xml</id><title type="html">AutoShiftOps</title><subtitle>Tech with Sajja‚Äôs ‚Äî DevOps, Cloud &amp; AI simplified</subtitle><entry><title type="html">üß† CPU-Only LLM Inference Explained: Quantization, GGUF, and llama.cpp</title><link href="https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/28/cpu-only-llm-inference-explained.html" rel="alternate" type="text/html" title="üß† CPU-Only LLM Inference Explained: Quantization, GGUF, and llama.cpp" /><published>2025-12-28T00:00:00+00:00</published><updated>2025-12-28T00:00:00+00:00</updated><id>https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/28/cpu-only-llm-inference-explained</id><content type="html" xml:base="https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/28/cpu-only-llm-inference-explained.html"><![CDATA[<h1 id="running-large-language-models-on-cpu-a-practical-guide-to-cpu-only-llm-inference">Running Large Language Models on CPU: A Practical Guide to CPU-Only LLM Inference</h1>

<blockquote>
  <p><em>No GPUs. No cloud scaling. Just Linux, CPUs, and solid systems engineering.</em></p>
</blockquote>

<p>Large Language Models (LLMs) are often associated with expensive GPUs and cloud infrastructure. However, for <strong>development, research, privacy-sensitive environments, and cost-controlled setups</strong>, running LLMs <strong>entirely on CPU</strong> is not only possible ‚Äî it‚Äôs practical.</p>

<p>This post is a <strong>complete, end-to-end guide</strong> to running <strong>large models (13B‚Äì27B+) on CPU-only hardware</strong>, using modern quantization techniques and efficient runtimes like <code class="language-plaintext highlighter-rouge">llama.cpp</code>.</p>

<p>By the end, you‚Äôll understand:</p>
<ul>
  <li>Why CPU-based LLMs exist</li>
  <li>What <em>quantization</em> and <em>inference</em> really mean</li>
  <li>How to set up a Linux system for CPU inference</li>
  <li>How large models can realistically run without GPUs</li>
  <li>A reproducible workflow you can use immediately</li>
</ul>

<hr />

<h2 id="why-run-llms-on-cpu">Why Run LLMs on CPU?</h2>

<p>Let‚Äôs address the obvious question first.</p>

<h3 id="if-gpus-are-faster-why-bother-with-cpu">If GPUs are faster, why bother with CPU?</h3>

<p>Because <strong>speed is not the only constraint</strong>.</p>

<p>CPU-based LLMs are ideal when you need:</p>

<ul>
  <li><strong>Low-cost experimentation</strong> (no $10K GPUs)</li>
  <li><strong>Offline or air-gapped environments</strong></li>
  <li><strong>Privacy &amp; compliance</strong> (healthcare, finance, legal)</li>
  <li><strong>On-prem developer tooling</strong></li>
  <li><strong>Edge or internal R&amp;D systems</strong></li>
  <li><strong>Predictable, reproducible environments</strong></li>
</ul>

<p>For many teams, <strong>‚Äúfast enough‚Äù beats ‚Äúfastest possible.‚Äù</strong></p>

<hr />

<h2 id="core-concepts-no-ml-background-required">Core Concepts (No ML Background Required)</h2>

<h3 id="1-what-is-inference">1. What Is Inference?</h3>

<p><strong>Inference</strong> is the act of <em>using</em> a trained model to generate text.</p>

<ul>
  <li>Training = learning weights (expensive, GPU-heavy)</li>
  <li>Inference = reading weights + predicting tokens (much cheaper)</li>
</ul>

<p>This guide is <strong>only about inference</strong>.</p>

<hr />

<h3 id="2-why-large-models-dont-fit-on-cpu-by-default">2. Why Large Models Don‚Äôt Fit on CPU (By Default)</h3>

<p>A 27B model in FP16 format:</p>
<ul>
  <li>27B parameters √ó 2 bytes ‚âà 54 GB RAM</li>
</ul>

<p>That‚Äôs before runtime overhead.</p>

<p>This is why <strong>quantization</strong> exists.</p>

<hr />

<h2 id="quantization-explained-simply">Quantization Explained (Simply)</h2>

<h3 id="what-is-quantization">What Is Quantization?</h3>

<p>Quantization reduces the <strong>precision</strong> of model weights to save memory and speed up inference.</p>

<table>
  <thead>
    <tr>
      <th>Format</th>
      <th>Memory</th>
      <th>Quality</th>
      <th>Use Case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FP16</td>
      <td>Very High</td>
      <td>Best</td>
      <td>Training / GPUs</td>
    </tr>
    <tr>
      <td>Q6</td>
      <td>Medium</td>
      <td>Very Good</td>
      <td>CPU, high quality</td>
    </tr>
    <tr>
      <td>Q5</td>
      <td>Lower</td>
      <td>Good</td>
      <td>CPU, balanced</td>
    </tr>
    <tr>
      <td>Q4</td>
      <td>Lowest</td>
      <td>Acceptable</td>
      <td>CPU, fastest</td>
    </tr>
  </tbody>
</table>

<p>Quantization:</p>
<ul>
  <li>Reduces RAM usage by <strong>4‚Äì6√ó</strong></li>
  <li>Improves CPU cache efficiency</li>
  <li>Makes CPU inference viable</li>
</ul>

<hr />

<h2 id="why-gguf-format">Why GGUF Format?</h2>

<p>Modern CPU runtimes use <strong>GGUF</strong>, a binary format that:</p>

<ul>
  <li>Packs weights + tokenizer together</li>
  <li>Is optimized for memory-mapped loading</li>
  <li>Avoids Python overhead</li>
  <li>Works directly with C/C++ inference engines</li>
</ul>

<p>Think of GGUF as:</p>
<blockquote>
  <p><em>‚ÄúDocker images for LLM weights.‚Äù</em></p>
</blockquote>

<hr />

<h2 id="the-cpu-inference-stack">The CPU Inference Stack</h2>

<p>Here‚Äôs the <strong>minimal, production-grade stack</strong>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Raw Model Weights (HF / Google)
‚Üì
Conversion ‚Üí GGUF
‚Üì
Quantization (Q4/Q5/Q6)
‚Üì
CPU Runtime (llama.cpp)
‚Üì
Optimized Linux Execution
</code></pre></div></div>

<p>No PyTorch runtime is needed at inference time.</p>

<hr />

<h2 id="system-requirements-realistic">System Requirements (Realistic)</h2>

<h3 id="minimum-recommended-specs">Minimum Recommended Specs</h3>

<ul>
  <li>Ubuntu 22.04+</li>
  <li>x86_64 CPU with <strong>AVX2</strong> (AVX512 preferred)</li>
  <li><strong>128 GB RAM</strong> for 27B models</li>
  <li>16‚Äì32 CPU cores</li>
  <li>SSD storage</li>
</ul>

<blockquote>
  <p>Tip: CPUs with high memory bandwidth matter more than clock speed.</p>
</blockquote>

<hr />

<h2 id="step-by-step-quick-start">Step-by-Step Quick Start</h2>

<h3 id="1-install-system-dependencies">1. Install System Dependencies</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\</span>
  build-essential cmake git wget <span class="se">\</span>
  python3 python3-venv python3-pip <span class="se">\</span>
  numactl htop perf libopenblas-dev
</code></pre></div></div>

<h3 id="2-build-the-cpu-inference-engine">2. Build the CPU Inference Engine</h3>

<p>llama.cpp is the gold standard for CPU LLM inference.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/ggerganov/llama.cpp.git
cd llama.cpp
make LLAMA_AVX2=1 LLAMA_AVX512=1 LLAMA_BLAS=1 -j$(nproc)
</code></pre></div></div>

<p>Verify CPU features:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lscpu | grep AVX
</code></pre></div></div>

<h3 id="3-download-model-weights">3. Download Model Weights</h3>

<p>Download official model weights (example shown):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir -p models/raw
cd models/raw
wget &lt;official-model-url&gt;
</code></pre></div></div>

<p>Always respect model licenses.</p>

<h3 id="4-convert-to-gguf">4. Convert to GGUF</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python llama.cpp/tools/convert-hf-to-gguf.py \
  models/raw/model.safetensors \
  models/gguf/model.gguf
</code></pre></div></div>

<p>This step:</p>

<ul>
  <li>Aligns tokenizer</li>
  <li>Normalizes weight layout</li>
  <li>Ensures runtime compatibility</li>
</ul>

<h3 id="5-quantize-the-model">5. Quantize the Model</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./quantize models/gguf/model.gguf models/quantized/model-q4.gguf q4_k_m
./quantize models/gguf/model.gguf models/quantized/model-q5.gguf q5_k_m
./quantize models/gguf/model.gguf models/quantized/model-q6.gguf q6_k
</code></pre></div></div>

<p>Start with Q4. Move up if quality is insufficient.</p>

<h3 id="6-run-inference-optimized">6. Run Inference (Optimized)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>numactl --cpunodebind=0 --membind=0 \
./main -m models/quantized/model-q4.gguf \
--threads 16 \
-p "Explain CPU-based LLM inference"
</code></pre></div></div>

<p>Tune:</p>

<ul>
  <li>
    <p>‚Äìthreads</p>
  </li>
  <li>
    <p>NUMA binding</p>
  </li>
  <li>
    <p>Batch size</p>
  </li>
  <li>
    <p>Performance Expectations (Honest)</p>
  </li>
</ul>

<p>For a 27B model on CPU:</p>

<table>
  <thead>
    <tr>
      <th>Quantization</th>
      <th>Tokens/sec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Q4</td>
      <td>4‚Äì7 t/s</td>
    </tr>
    <tr>
      <td>Q5</td>
      <td>3‚Äì5 t/s</td>
    </tr>
    <tr>
      <td>Q6</td>
      <td>2‚Äì4 t/s</td>
    </tr>
  </tbody>
</table>

<p>This is not chatGPT speed ‚Äî but it is:</p>

<ul>
  <li>
    <p>Stable</p>
  </li>
  <li>
    <p>Cheap</p>
  </li>
  <li>
    <p>Private</p>
  </li>
  <li>
    <p>Predictable</p>
  </li>
</ul>

<h2 id="common-pitfalls">Common Pitfalls</h2>
<p>‚ùå Tokenizer mismatch</p>

<ul>
  <li>Always convert with the correct tokenizer.</li>
</ul>

<p>‚ùå Running out of memory</p>

<ul>
  <li>Use lower quantization or fewer threads.</li>
</ul>

<p>‚ùå Poor performance</p>

<p>Check:</p>

<ul>
  <li>
    <p>AVX support</p>
  </li>
  <li>
    <p>NUMA locality</p>
  </li>
  <li>
    <p>BLAS enabled</p>
  </li>
</ul>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>CPU-based LLM inference is not a workaround ‚Äî it‚Äôs a legitimate engineering choice.</p>

<p>With the right:</p>

<ul>
  <li>Quantization</li>
  <li>Runtime</li>
  <li>Linux tuning</li>
  <li>Documentation</li>
</ul>

<p>You can run surprisingly large models on commodity hardware.</p>

<p>And most importantly ‚Äî you understand exactly how it works.</p>

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li>llama.cpp GitHub</li>
  <li>GGUF specification</li>
  <li>CPU vectorization (AVX2 / AVX512)</li>
  <li>NUMA performance tuning</li>
</ul>]]></content><author><name></name></author><category term="DevOps" /><category term="AI" /><category term="LLMs" /><category term="Machine Learning" /><category term="LLMs" /><category term="CPU inference" /><category term="quantization" /><category term="llama.cpp" /><category term="large language models" /><category term="AI" /><category term="machine learning" /><summary type="html"><![CDATA[A comprehensive guide to running large language models (LLMs) entirely on CPU hardware using quantization techniques and efficient runtimes like llama.cpp.]]></summary></entry><entry><title type="html">ü§ñ Best Practices for Developing AI Agents</title><link href="https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/27/best-practices-for-developing-ai-agents.html" rel="alternate" type="text/html" title="ü§ñ Best Practices for Developing AI Agents" /><published>2025-12-27T00:00:00+00:00</published><updated>2025-12-27T00:00:00+00:00</updated><id>https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/27/best-practices-for-developing-ai-agents</id><content type="html" xml:base="https://autoshiftops.com/devops/ai/llms/machine%20learning/2025/12/27/best-practices-for-developing-ai-agents.html"><![CDATA[<p>Here‚Äôs a comprehensive guide for developing robust, reliable AI agents:</p>

<h2 id="1-design--architecture">1. Design &amp; Architecture</h2>
<h3 id="11-clear-agent-purpose">1.1 Clear Agent Purpose</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ‚úÖ Good: Clear, single responsibility
</span><span class="k">class</span> <span class="nc">IncidentAnalysisAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
    Agent responsible for:
    - Fetching incidents from API
    - Analyzing incident data
    - Extracting actionable insights
    - Providing recommendations
    </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">api_client</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">api_client</span> <span class="o">=</span> <span class="n">api_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">analyze_incidents</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Analyze single incident</span><span class="sh">"""</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">batch_analyze</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">incidents</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Analyze multiple incidents</span><span class="sh">"""</span>
        <span class="k">pass</span>
</code></pre></div></div>

<h3 id="12-separation-of-concerns">1.2 Separation of Concerns</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ‚úÖ Good: Separate components
</span><span class="k">class</span> <span class="nc">IncidentAgent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">fetcher</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">analyzer</span><span class="p">,</span> <span class="n">recommender</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fetcher</span> <span class="o">=</span> <span class="n">fetcher</span>          <span class="c1"># Fetch data  
</span>        <span class="n">self</span><span class="p">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>            <span class="c1"># Parse data
</span>        <span class="n">self</span><span class="p">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">analyzer</span>        <span class="c1"># Analyze data
</span>        <span class="n">self</span><span class="p">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span>            <span class="c1"># Write results
</span>    
<span class="c1"># ‚ùå Bad: Everything mixed together
</span><span class="k">class</span> <span class="nc">MonolithicAgent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">api_client</span><span class="p">):</span>
        <span class="c1"># Fetch, parse, analyze, and write all in one class
</span>        <span class="k">pass</span>
</code></pre></div></div>

<h2 id="2-error-handling--resilience">2. Error Handling &amp; Resilience</h2>
<h3 id="21-comprehensive-error-handling">2.1 Comprehensive Error Handling</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AIAgent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
        <span class="n">self</span><span class="p">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
    
    <span class="k">def</span> <span class="nf">retry_with_backoff</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="c1">### Decorator for retrying with exponential backoff ###
</span>        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">max_retries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Attempt </span><span class="si">{</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">max_retries</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">return</span> <span class="nf">func</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">All </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">max_retries</span><span class="si">}</span><span class="s"> attempts failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                        <span class="k">raise</span>
                    
                    <span class="n">wait_time</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span> <span class="c1"># Exponential backoff
</span>                    <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Attempt </span><span class="si">{</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s"> failed. Retrying in </span><span class="si">{</span><span class="n">wait_time</span><span class="si">}</span><span class="s">s: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    
    <span class="nd">@retry_with_backoff</span>
    <span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Fetch data from a URL with retries and timeout</span><span class="sh">"""</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="nf">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="22-graceful-degradation">2.2 Graceful Degradation</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ‚úÖ Good: Provide fallback when API fails
</span><span class="k">class</span> <span class="nc">RobustIncidentAgent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">get_incidents</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">fetch_from_primary_api</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Primary API failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">. Falling back to secondary API.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">fetch_from_cache</span><span class="p">()</span>      <span class="c1"># Fallback to cached data
</span>    
    <span class="k">def</span> <span class="nf">analyze_with_fallback</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">advanced_analysis</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Advanced analysis failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">. Using basic analysis.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">basic_analysis</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span> <span class="c1"># Fallback to basic analysis
</span></code></pre></div></div>

<h2 id="3-input-validation--simulation">3. Input Validation &amp; Simulation</h2>
<h3 id="31-strict-input-validation">3.1 Strict Input Validation</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">Field</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="k">class</span> <span class="nc">IncidentData</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="c1">### Validate incident data structure ###
</span>    <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="sh">'</span><span class="s">incident_id</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">incident_id_not_empty</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">'</span><span class="s">incident_id must not be empty</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
    
    <span class="nd">@validator</span><span class="p">(</span><span class="sh">'</span><span class="s">severity</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">severity_valid</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">valid_severities</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">low</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">medium</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">high</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">critical</span><span class="sh">'</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_severities</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">severity must be one of </span><span class="si">{</span><span class="n">valid_severities</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
    
<span class="k">class</span> <span class="nc">IncidentAgent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">process_incident</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Validate data structure
</span>            <span class="n">incident</span> <span class="o">=</span> <span class="nc">IncidentData</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Processing incident: </span><span class="si">{</span><span class="n">incident</span><span class="p">.</span><span class="n">incident_id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Invalid incident data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
</code></pre></div></div>

<h3 id="32-sanitize-external-inputs">3.2 Sanitize External Inputs</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="k">def</span> <span class="nf">sanitize_input</span><span class="p">(</span><span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Sanitize user input to prevent injection attacks</span><span class="sh">"""</span>
    <span class="c1"># Remove potentially dangerous characters
</span>    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="nf">escape</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[&lt;&gt;\"\'%;()&amp;+]</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">,</span> <span class="n">sanitized</span><span class="p">)</span>
    <span class="n">sanitized</span> <span class="o">=</span> <span class="n">sanitized</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sanitized</span>

<span class="k">def</span> <span class="nf">sanitize_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1">### Prevent directory traversal attacks ###
</span>    <span class="n">path</span> <span class="o">=</span> <span class="n">file_path</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">..</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">//</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span>
</code></pre></div></div>

<h2 id="4-logging--monitoring">4. Logging &amp; Monitoring</h2>
<h3 id="41-comprehensive-logging">4.1 Comprehensive Logging</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span> <span class="nc">StructuredLogger</span><span class="p">:</span>
    <span class="c1">### Structured logging for AI agents ###
</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">setup_handlers</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setup_handlers</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># Console handler
</span>        <span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">()</span>
        <span class="n">console_handler</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># File handler
</span>        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">FileHandler</span><span class="p">(</span><span class="sh">'</span><span class="s">agent.log</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>

        <span class="c1"># Formatter
</span>        <span class="n">log_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="sh">'</span><span class="s">%(asctime)s - %(name)s - %(levelname)s - %(message)s</span><span class="sh">'</span><span class="p">)</span>

        <span class="n">console_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">log_formatter</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">log_formatter</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">log_action</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1">### Log structured action data ###
</span>        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">utcnow</span><span class="p">().</span><span class="nf">isoformat</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">details</span><span class="sh">"</span><span class="p">:</span> <span class="n">details</span>
        <span class="p">}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">log_entry</span><span class="p">))</span>

<span class="c1"># Usage details
</span><span class="n">logger</span> <span class="o">=</span> <span class="nc">StructuredLogger</span><span class="p">(</span><span class="n">__name_</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">log_action</span><span class="p">(</span><span class="sh">'</span><span class="s">fetch_incidents</span><span class="sh">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">success</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">duration_ms</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1234</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="42-monitoring--metrics">4.2 Monitoring &amp; Metrics</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Guage</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">class</span> <span class="nc">MonitoredAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent with monitoring and metrics </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># Metrics
</span>        <span class="n">self</span><span class="p">.</span><span class="n">request_count</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span>
            <span class="sh">'</span><span class="s">agent_requests_total</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">Total requests</span><span class="sh">'</span><span class="p">,</span>
            <span class="p">[</span><span class="sh">'</span><span class="s">method</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">request_duration</span> <span class="o">=</span> <span class="nc">Histogram</span><span class="p">(</span>
            <span class="sh">'</span><span class="s">agent_request_duration_seconds</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">Request duration</span><span class="sh">'</span><span class="p">,</span>
            <span class="p">[</span><span class="sh">'</span><span class="s">method</span><span class="sh">'</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">active_requests</span> <span class="o">=</span> <span class="nc">Guage</span><span class="p">(</span>
            <span class="sh">'</span><span class="s">agent_active_requests</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">Active requests</span><span class="sh">'</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="c1">### Fetch with monitoring ###
</span>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">active_requests</span><span class="p">.</span><span class="nf">inc</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">response</span><span class="p">.</span><span class="nf">raise_for_status</span><span class="p">()</span>

            <span class="n">self</span><span class="p">.</span><span class="n">request_count</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
                <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">fetch</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">status</span><span class="o">=</span><span class="sh">'</span><span class="s">success</span><span class="sh">'</span>
            <span class="p">).</span><span class="nf">inc</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
        
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">request_count</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
                <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">fetch</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">status</span><span class="o">=</span><span class="sh">'</span><span class="s">raise</span><span class="sh">'</span>
            <span class="p">).</span><span class="nf">inc</span><span class="p">()</span>
            <span class="k">raise</span>
        
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">self</span><span class="p">.</span><span class="n">request_duration</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">fetch</span><span class="sh">'</span><span class="p">).</span><span class="nf">observe</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">active_requests</span><span class="p">.</span><span class="nf">dec</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="5-testing--quality-assurance">5. Testing &amp; Quality Assurance</h2>
<h3 id="51-unit-testing">5.1 Unit Testing</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pytest</span>
<span class="kn">from</span> <span class="n">unittest.mock</span> <span class="kn">import</span> <span class="n">Mock</span><span class="p">,</span> <span class="n">patch</span>

<span class="k">class</span> <span class="nc">TestIncidentAgent</span><span class="p">:</span>
    <span class="nd">@pytest.fixture</span>
    <span class="k">def</span> <span class="nf">agent</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1">### Create test agent ###
</span>        <span class="n">mock_api</span> <span class="o">=</span> <span class="nc">Mock</span><span class="p">()</span>
        <span class="k">return</span> <span class="nc">IncidentAgent</span><span class="p">(</span><span class="n">api</span><span class="o">=</span><span class="n">mock_api</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">test_extract_target_name</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
        <span class="c1">### Test target name extraction ###
</span>        <span class="n">description</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Target Name: xyz.example.com</span><span class="sh">"</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">extract_target_name</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="sh">"</span><span class="s">xyz.example.com</span><span class="sh">"</span>
    
    <span class="k">def</span> <span class="nf">test_invalid_incident_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
        <span class="c1">### Test invalid incident data handling ###
</span>        <span class="n">invalid_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">incident_id</span><span class="sh">'</span><span class="p">:</span> <span class="sh">''</span><span class="p">}</span> <span class="c1"># Empty ID
</span>        <span class="k">with</span> <span class="n">pytest</span><span class="p">.</span><span class="nf">raises</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">):</span>
            <span class="n">agent</span><span class="p">.</span><span class="nf">process_incident</span><span class="p">(</span><span class="n">invalid_data</span><span class="p">)</span>
    
    <span class="nd">@patch</span><span class="p">(</span><span class="sh">'</span><span class="s">requests.get</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_fetch_with_proxy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">mock_get</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
        <span class="c1">### Test fetch with proxy ###
</span>        <span class="n">mock_get</span><span class="p">.</span><span class="n">return_value</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">result</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]}</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">fetch_incidents</span><span class="p">()</span>

        <span class="k">assert</span> <span class="n">mock_get</span><span class="p">.</span><span class="n">called</span>
        <span class="n">mock_get</span><span class="p">.</span><span class="nf">assert_called_with</span><span class="p">(</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">proxies</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://proxy:8080</span><span class="sh">'</span><span class="p">}</span>
        <span class="p">)</span>
</code></pre></div></div>
<h3 id="52-integration-testing">5.2 Integration Testing</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pytest</span>
<span class="kn">import</span> <span class="n">responses</span>

<span class="k">class</span> <span class="nc">TestAgentIntegration</span><span class="p">:</span>
    <span class="nd">@responses.activate</span>
    <span class="k">def</span> <span class="nf">test_full_incidents_processing</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1">### Test complete incidents processing flow ###
</span>        
        <span class="c1"># Mock API response
</span>        <span class="n">responses</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span>
            <span class="n">responses</span><span class="p">.</span><span class="n">GET</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">https://api.example.com/incidents</span><span class="sh">'</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">[{</span>
                <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">INC123</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Target Name: xyz.example.com</span><span class="se">\n</span><span class="s">Target Type: server</span><span class="sh">'</span><span class="p">,</span>
            <span class="p">}]</span>
            <span class="n">status</span><span class="o">=</span><span class="mi">200</span>
        <span class="p">)</span>

        <span class="c1"># Create agent and process
</span>        <span class="n">agent</span> <span class="o">=</span> <span class="nc">IncidentAgent</span><span class="p">()</span>
        <span class="n">incidents</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">fetch_incidents</span><span class="p">()</span>

        <span class="c1"># Assertions
</span>        <span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">incidents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="n">inciedents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="sh">'</span><span class="s">incident_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">INC123</span><span class="sh">'</span>
        <span class="k">assert</span> <span class="n">incidents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="sh">'</span><span class="s">target_name</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">xyz.example.com</span><span class="sh">'</span>
</code></pre></div></div>

<h2 id="6-configuration-management">6. Configuration Management</h2>
<h3 id="61-environment-based-configuration">6.1 Environment-Based Configuration</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">from</span> <span class="n">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="n">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="nf">load_dotenv</span><span class="p">()</span>  <span class="c1"># Load .env file
</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent configuration </span><span class="sh">"""</span>

    <span class="c1"># API settings
</span>    <span class="n">api_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_URL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https://api.example.com</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">api_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_TIMEOUT</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">30</span><span class="sh">'</span><span class="p">))</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">MAX_RETRIES</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">))</span>

    <span class="c1"># Proxy settings
</span>    <span class="n">proxy_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">PROXY_ENABLED</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">false</span><span class="sh">'</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span>
    <span class="n">proxy_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">PROXY_URL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https://proxy:8080</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># Logging
</span>    <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">LOG_LEVEL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">INFO</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">LOG_FILE</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">agent.log</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># Security
</span>    <span class="n">api_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_TOKEN</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">)</span>
    <span class="n">verify_ssl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">VERIFY_SSL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> validate configuration </span><span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">api_url</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">API_URL must be set</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">api_token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">API_TOKEN must be set</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># Usage
</span><span class="n">config</span> <span class="o">=</span> <span class="nc">Config</span><span class="p">()</span>
<span class="n">config</span><span class="p">.</span><span class="nf">validate</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="62-env-file">6.2 .env file</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># API Configuration
</span><span class="n">API_URL</span><span class="o">=</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">API_TIMEOUT</span><span class="o">=</span><span class="mi">30</span>
<span class="n">MAX_RETRIES</span><span class="o">=</span><span class="mi">3</span>

<span class="c1"># Proxy Configuration
</span><span class="n">PROXY_ENABLED</span><span class="o">=</span><span class="n">true</span>
<span class="n">PROXY_URL</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">proxy</span><span class="p">:</span><span class="mi">8080</span>

<span class="c1"># Logging
</span><span class="n">LOG_LEVEL</span><span class="o">=</span><span class="n">DEBUG</span>
<span class="n">LOG_FILE</span><span class="o">=</span><span class="n">agent</span><span class="p">.</span><span class="n">log</span>

<span class="c1"># Security
</span><span class="n">API_TOKEN</span><span class="o">=</span><span class="n">your_api_token_here</span>
<span class="n">VERIFY_SSL</span><span class="o">=</span><span class="n">true</span>
</code></pre></div></div>

<h2 id="7-security-best-practices">7. Security Best Practices</h2>
<h3 id="71-secure-credential-management">7.1 Secure Credential Management</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="k">class</span> <span class="nc">SecureCredentials</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Manage credentials securely </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># Never hardcode key - use environment variable
</span>        <span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">ENCRYPTION_KEY</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">ENCRYPTION_KEY must be set in environment variables</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">cipher</span> <span class="o">=</span> <span class="nc">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s"> Encrypt sensitive token </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">decode</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">encrypted_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s"> Decrypt sensitive token </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_token</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">decode</span><span class="p">()</span>

<span class="c1"># ‚ùå BAD: Hardcoding credentials
</span><span class="n">api_token</span> <span class="o">=</span> <span class="sh">"</span><span class="s">secret_token_123</span><span class="sh">"</span>

<span class="c1"># ‚úÖ GOOD: Using secure credential management
</span><span class="n">api_token</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_TOKEN_ENCRYPTED</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="72-rate-limiting">7.2 Rate Limiting</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">requests.adapters</span> <span class="kn">import</span> <span class="n">HTTPAdapter</span>
<span class="kn">from</span> <span class="n">urllib3.util.retry</span> <span class="kn">import</span> <span class="n">Retry</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">class</span> <span class="nc">RateLimitedAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent with rate limiting </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">requests_per_second</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">requests_per_second</span> <span class="o">=</span> <span class="n">requests_per_second</span>
        <span class="n">self</span><span class="p">.</span><span class="n">min_interval</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">requests_per_second</span>
        <span class="n">self</span><span class="p">.</span><span class="n">last_request_time</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">_wait_if_needed</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Wait to maintain rate limit </span><span class="sh">"""</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">last_request_time</span>
        <span class="k">if</span> <span class="n">elapsed</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">min_interval</span><span class="p">:</span>
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">min_interval</span> <span class="o">-</span> <span class="n">elapsed</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Fetch with rate limiting </span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">_wait_if_needed</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">last_request_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="8-performance-optimization">8. Performance Optimization</h2>
<h3 id="81-caching">8.1 Caching</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">funtools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span> <span class="nc">CachedAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent with intelligent caching </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache_ttl</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># 5 minutes
</span>    
    <span class="k">def</span> <span class="nf">get_incidents</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">force_refresh</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Get incidents with caching </span><span class="sh">"""</span>

        <span class="n">cache_key</span> <span class="o">=</span> <span class="sh">'</span><span class="s">incidents</span><span class="sh">'</span>

        <span class="c1"># Check cache
</span>        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_refresh</span><span class="p">:</span>
            <span class="n">cached_data</span><span class="p">,</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestamp</span> <span class="o">&lt;</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">cache_ttl</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">cached_data</span>
        
        <span class="c1"># Fetch fresh data
</span>        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Fetching fresh incidents</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">incidents</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_fetch_from_api</span><span class="p">()</span>

        <span class="c1"># Update cache
</span>        <span class="n">self</span><span class="p">.</span><span class="n">cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">incidents</span><span class="p">,</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">incidents</span>
    
    <span class="k">def</span> <span class="nf">_fetch_from_api</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Fetch from API </span><span class="sh">"""</span>
        <span class="k">pass</span>
</code></pre></div></div>

<h3 id="82-batch-processing">8.2 Batch Processing</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Iterator</span>

<span class="k">class</span> <span class="nc">BatchedAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Process incidents in batches </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">process_in_batches</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">incidents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]:</span>
        <span class="sh">"""</span><span class="s"> process incidents in batches to reduce memory </span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">incidents</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">incidents</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Processing batch </span><span class="si">{</span><span class="n">i</span> <span class="o">//</span> <span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
           
            <span class="k">for</span> <span class="n">incident</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">self</span><span class="p">.</span><span class="nf">process_incident</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="9-documentation--code-quality">9. Documentation &amp; Code Quality</h2>
<h3 id="91-type-hints">9.1 Type Hints</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="k">class</span> <span class="nc">DocumentedAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Well-documented agent </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">extract_target_name</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sh">"""</span><span class="s"> Extract target name from incident description

        Args:
            description (str): Incident description text

        Returns:
            The Target name if found, None Otherwise

        Raises:
            ValueError: If description is empty
        
        Example:
</span><span class="gp">            &gt;&gt;&gt;</span> <span class="n">agent</span> <span class="o">=</span> <span class="nc">DocumentedAgent</span><span class="p">()</span>
            <span class="o">&gt;&gt;&gt;</span> <span class="n">agent</span><span class="p">.</span><span class="nf">extract_target_name</span><span class="p">(</span><span class="sh">"</span><span class="s">Target Name: xyz.example.com</span><span class="sh">"</span><span class="p">)</span>
            <span class="sh">'</span><span class="s">xyz.example.com</span><span class="sh">'</span>
        <span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">description</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Description must not be empty</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">Target Name:\s*(\S+)</span><span class="sh">'</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">match</span><span class="p">.</span><span class="nf">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">batch_process</span><span class="p">(</span>
        <span class="n">self</span><span class="p">,</span>
        <span class="n">incidents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sh">"""</span><span class="s"> 
        Process multiple incidents

        Args:
            incidents: List of incident dictionaries
            parallel: Whether to process in parallel

        Returns:
            Tuple of (processed_incidents, error_ids)
        </span><span class="sh">"""</span>
        <span class="k">pass</span>
</code></pre></div></div>

<h2 id="10-observability--debugging">10. Observability &amp; Debugging</h2>
<h3 id="101-debugging-mode">10.1 Debugging Mode</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>

<span class="k">class</span> <span class="nc">DebuggableAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent with debug mode </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">setup_logging</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Setup logging based on debug mode </span><span class="sh">"""</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span> <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">debug</span> <span class="k">else</span> <span class="n">logging</span><span class="p">.</span><span class="n">INFO</span>
        <span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Fetch with debug output </span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Fetching data from URL: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Using proxies: </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">proxies</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Response status: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Response size: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s"> bytes</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></div>
<h3 id="102-health-checks">10.2 Health Checks</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HealthCheckAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Agent with health checks </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">health_check</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sh">"""</span><span class="s"> check agent health </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">api_connectivity</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_check_api</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">proxy_connectivity</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_check_proxy</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">database_connection</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_check_database</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">cache_health</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_check_cache</span><span class="p">()</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_check_api</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s"> Check API connectivity </span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">api_url</span><span class="si">}</span><span class="s">/health</span><span class="sh">"</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
        <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</code></pre></div></div>

<h2 id="-quick-refence-checklist">‚úÖ Quick Refence Checklist</h2>
<ul>
  <li>‚úÖ Single responsibility principle</li>
  <li>‚úÖ Comprehensive error handling with retries</li>
  <li>‚úÖ Input validation and sanitization</li>
  <li>‚úÖ Structured logging</li>
  <li>‚úÖ Unit &amp; Integration testing</li>
  <li>‚úÖ Configuration management</li>
  <li>‚úÖ Security best practices</li>
  <li>‚úÖ Rate limiting and Caching</li>
  <li>‚úÖ Type hints and documentation</li>
  <li>‚úÖ Health checks and monitoring</li>
  <li>‚úÖ Gradeful degradation</li>
  <li>‚úÖ Retry logic with backoff</li>
  <li>‚úÖ Environment-based configuration</li>
  <li>‚úÖ Secrets management</li>
  <li>‚úÖ Performance optimization</li>
</ul>

<h2 id="-complete-production-ready-agent-template">üöÄ Complete Production-Ready Agent Template</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="n">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="n">api_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_URL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https://api.example.com</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">api_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">API_TIMEOUT</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">30</span><span class="sh">'</span><span class="p">))</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">MAX_RETRIES</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">))</span>
    <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">LOG_LEVEL</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">INFO</span><span class="sh">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ProductionAgent</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s"> Production-ready AI Agent </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="nc">Config</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_setup_logging</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">_setup_logging</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Setup structured logging </span><span class="sh">"""</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">log_level</span><span class="p">)</span>

        <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">()</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">Formatter</span><span class="p">(</span><span class="sh">'</span><span class="s">%(asctime)s - %(name)s - %(levelname)s - %(message)s</span><span class="sh">'</span><span class="p">)</span>

        <span class="n">handler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">logger</span>

    <span class="k">def</span> <span class="nf">retry</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s"> Retry decorator with backoff </span><span class="sh">"""</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">max_retries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">All retries failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                        <span class="k">raise</span>
                    <span class="n">wait_time</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Attempt </span><span class="si">{</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s"> failed. Retrying in </span><span class="si">{</span><span class="n">wait_time</span><span class="si">}</span><span class="s">s: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    
    <span class="nd">@retry</span>
    <span class="k">def</span> <span class="nf">fetch_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s"> Fetch data with retry logic </span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Fetching from: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">api_timeout</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="nf">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
        <span class="sh">"""</span><span class="s"> Process data safely </span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Processing data</span><span class="sh">"</span><span class="p">)</span>
            <span class="c1"># Your processing logic here
</span>            <span class="k">return</span> <span class="n">data</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Processing failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>

<span class="c1"># Usage
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="nc">ProductionAgent</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">fetch_data</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">https://api.example.com/incidents</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">processed</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<p>This comprehensive guide covers all aspects of developing professional AI agents! üéØ</p>]]></content><author><name></name></author><category term="DevOps" /><category term="AI" /><category term="LLMs" /><category term="Machine Learning" /><category term="LLMs" /><category term="AI agents" /><category term="best practices" /><category term="software engineering" /><category term="machine learning" /><summary type="html"><![CDATA[A comprehensive guide to best practices for developing robust, reliable AI agents with code examples and patterns.]]></summary></entry><entry><title type="html">‚ÜîÔ∏èNew Relic to ServiceNow Incident Automation(Lab Guide)</title><link href="https://autoshiftops.com/new%20relic/serivenow/2025/12/22/new-relic-to-service-now-incident-automation.html" rel="alternate" type="text/html" title="‚ÜîÔ∏èNew Relic to ServiceNow Incident Automation(Lab Guide)" /><published>2025-12-22T00:00:00+00:00</published><updated>2025-12-22T00:00:00+00:00</updated><id>https://autoshiftops.com/new%20relic/serivenow/2025/12/22/new-relic-to-service-now-incident-automation</id><content type="html" xml:base="https://autoshiftops.com/new%20relic/serivenow/2025/12/22/new-relic-to-service-now-incident-automation.html"><![CDATA[<h2 id="objective">Objective</h2>
<p>Create a closed-loop incident management system where New Relic automatically creates ServiceNow incidents when CPU usage is high and resolves them when usage returns to normal.</p>

<h2 id="architecture">Architecture:</h2>
<ol>
  <li><b>Monitor:</b> New Relic Infrastructure Agent monitors a local machine.</li>
  <li><b>Trigger:</b> NRQL Alert Policy detects CPU &gt; 5%.</li>
  <li><b>Transport:</b> New Relic Workflow sends a Webhook <code class="language-plaintext highlighter-rouge">POST</code> request.</li>
  <li><b>Logic:</b> ServiceNow Scripted REST API receives the request, checks for a <code class="language-plaintext highlighter-rouge">correlation_id</code>, and decides whether to <code class="language-plaintext highlighter-rouge">insert()</code> (Create) or <code class="language-plaintext highlighter-rouge">update()</code> (Close).</li>
</ol>

<h2 id="part-i-environment-setup">Part I: Environment Setup</h2>
<p>Before configuring the integration, you need to establish your ‚ÄúSandbox‚Äù environment.</p>

<h3 id="1-get-a-servicenow-personal-developer-instance-pdi">1. Get a ServiceNow Personal Developer Instance (PDI)</h3>
<p><i>ServiceNow does not run locally; you must use their cloud sandbox.</i></p>

<ol>
  <li>
    <p>Go to the <a href="https://developer.servicenow.com/">ServiceNow Developer Site</a>.</p>
  </li>
  <li>
    <p>Sign up for a free account.</p>
  </li>
  <li>
    <p>Click Request Instance.</p>
  </li>
  <li>
    <p>Wait a few minutes. You will receive:</p>

    <ul>
      <li>URL: e.g., <code class="language-plaintext highlighter-rouge">https://devXXXXX.service-now.com</code></li>
      <li>Username: e.g., <code class="language-plaintext highlighter-rouge">admin</code></li>
      <li>Password: e.g., <code class="language-plaintext highlighter-rouge">XXXXXX</code>(Save this securely)</li>
    </ul>
  </li>
  <li>
    <p>Log in to your instance using the provided URL, username, and password.</p>
  </li>
</ol>

<h3 id="2-get-new-relic--install-agent">2. Get New Relic &amp; Install Agent</h3>
<ol>
  <li>Sign up for a free New Relic account at <a href="https://newrelic.com/signup">New Relic Sign Up</a>.</li>
  <li>Once logged in, go to <b> Add Data &gt; Linux </b> (or MacOS/Windows depending on your local machine).</li>
  <li>Follow the instructions to run the installation command in your terminal.
    <ul>
      <li>Example (linux):
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-Ls</span> https://download.newrelic.com/install/newrelic-cli/scripts/install.sh | bash <span class="o">&amp;&amp;</span> <span class="nb">sudo </span><span class="nv">NEW_RELIC_API_KEY</span><span class="o">=</span>YOUR_API_KEY <span class="nv">NEW_RELIC_ACCOUNT_ID</span><span class="o">=</span>YOUR_ACCOUNT_ID newrelic <span class="nb">install</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Verify data is flowing by going to <b> Infrastructure &gt; Hosts </b> in New Relic.</li>
</ol>

<h2 id="part-ii-servicenow-configurationthe-listener">Part II: ServiceNow Configuration(The Listener)</h2>
<p>We will build a ‚ÄúSmart Endpoint‚Äù that accepts the alert data.</p>

<h3 id="1-create-the-api-container">1. Create the API Container</h3>
<ol>
  <li>In your ServiceNow PDI, use the Filter Navigator (top left) to search for ‚ÄúScripted REST APIs‚Äù.</li>
  <li>Click <b> New </b>.
    <ul>
      <li><b>Name:</b> <code class="language-plaintext highlighter-rouge">NewReliWebhook</code></li>
      <li><b>API ID:</b> <code class="language-plaintext highlighter-rouge">newrelic_handler</code></li>
    </ul>
  </li>
  <li>Click <b> Submit </b>.</li>
</ol>

<h3 id="2-create-the-resourcethe-endpoint">2. Create the Resource(The Endpoint)</h3>
<ol>
  <li>Open the <code class="language-plaintext highlighter-rouge">NewRelicWebhook</code> record you just created.</li>
  <li>Scroll down to the Resources tab and click <b> New </b>.
    <ul>
      <li><b>Name:</b> <code class="language-plaintext highlighter-rouge">HandleAlert</code></li>
      <li><b>HTTP Method:</b> <code class="language-plaintext highlighter-rouge">POST</code></li>
      <li><b>Relative Path:</b> <code class="language-plaintext highlighter-rouge">/incident</code></li>
    </ul>
  </li>
  <li>
    <p><b>The Script:</b> Delete the default code in the <b> Script </b> field and paste the following ‚ÄúTraffic Cop‚Äù logic:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="p">(</span><span class="kd">function</span> <span class="nf">process</span><span class="p">(</span><span class="cm">/*RESTAPIRequest*/</span> <span class="nx">request</span><span class="p">,</span> <span class="cm">/*RESTAPIResponse*/</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// 1. Parse the incoming JSON from New Relic</span>
     <span class="kd">var</span> <span class="nx">requestBody</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">nrIssueId</span> <span class="o">=</span> <span class="nx">requestBody</span><span class="p">.</span><span class="nx">issue_id</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">nrState</span> <span class="o">=</span> <span class="nx">requestBody</span><span class="p">.</span><span class="nx">current_state</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">nrTitle</span> <span class="o">=</span> <span class="nx">requestBody</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">nrCpu</span> <span class="o">=</span> <span class="nx">requestBody</span><span class="p">.</span><span class="nx">cpu_value</span><span class="p">;</span>

     <span class="c1">// 2. Look for an existing Incident with this New Relic Issue ID</span>
     <span class="kd">var</span> <span class="nx">gr</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GlideRecord</span><span class="p">(</span><span class="dl">'</span><span class="s1">incident</span><span class="dl">'</span><span class="p">);</span>
     <span class="nx">gr</span><span class="p">.</span><span class="nf">addQuery</span><span class="p">(</span><span class="dl">'</span><span class="s1">correlation_id</span><span class="dl">'</span><span class="p">,</span> <span class="nx">nrIssueId</span><span class="p">);</span>
     <span class="nx">gr</span><span class="p">.</span><span class="nf">query</span><span class="p">();</span>

     <span class="k">if </span><span class="p">(</span><span class="nx">gr</span><span class="p">.</span><span class="nf">next</span><span class="p">())</span> <span class="p">{</span>
         <span class="c1">// --- SCENARIO: UPDATE EXISTING INCIDENT ---</span>
         <span class="k">if </span><span class="p">(</span><span class="nx">nrState</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">CLOSED</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">// Set to 'Resolved' (Standard ID)</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nx">close_code</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Solved (Permanently)</span><span class="dl">'</span><span class="p">;</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nx">close_notes</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Cloased automatically by New Relic. Alert cleared.</span><span class="dl">'</span><span class="p">;</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nx">work_notes</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">New Relic reports issue is closed.</span><span class="dl">"</span><span class="p">;</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nf">update</span><span class="p">();</span>

             <span class="k">return</span> <span class="p">{</span> <span class="na">status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Incident Resolved</span><span class="dl">"</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">number</span> <span class="p">};</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
             <span class="c1">// Optional: Update work notes if it's just an update</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nx">work_notes</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Received update from New Relic. Current CPU: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">nrCpu</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">%</span><span class="dl">"</span><span class="p">;</span>
             <span class="nx">gr</span><span class="p">.</span><span class="nf">update</span><span class="p">();</span>
             <span class="k">return</span> <span class="p">{</span> <span class="na">status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Incident Updated</span><span class="dl">"</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">number</span> <span class="p">};</span>
         <span class="p">}</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
         <span class="c1">// --- SCENARIO: CREATE NEW INCIDENT ---</span>
         <span class="k">if </span><span class="p">(</span><span class="nx">nrState</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">ACTIVATED</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
             <span class="kd">var</span> <span class="nx">newInc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GlideRecord</span><span class="p">(</span><span class="dl">'</span><span class="s1">incident</span><span class="dl">'</span><span class="p">);</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nf">initialize</span><span class="p">();</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nx">short_description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">New Relic Alert: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">nrTitle</span><span class="p">;</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Automatic alert from New Relic.</span><span class="se">\n</span><span class="s2">Issue ID: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">nrIssueId</span> <span class="o">+</span> <span class="dl">"</span><span class="se">\n</span><span class="s2">CPU Usage: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">nrCpu</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">%</span><span class="dl">"</span><span class="p">;</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nx">correlation_id</span> <span class="o">=</span> <span class="nx">nrIssueId</span><span class="p">;</span> <span class="c1">// THIS IS CRITICAL</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nx">caller_id</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nf">getUserID</span><span class="p">();</span> <span class="c1">// Assign to API user</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nx">urgency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// High</span>
             <span class="nx">newInc</span><span class="p">.</span><span class="nf">insert</span><span class="p">();</span>

             <span class="k">return</span> <span class="p">{</span> <span class="na">status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Incident Created</span><span class="dl">"</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="nx">newInc</span><span class="p">.</span><span class="nx">number</span> <span class="p">};</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">})(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>Click <b>Submit.</b></li>
  <li><b>Important:</b> Note your full Endpoint URL. It will be: <code class="language-plaintext highlighter-rouge">https://devXXXXX.service-now.com/api/x_scope_id/newrelic_handler/incident</code></li>
</ol>

<h2 id="part-iii-new-relic-configurationthe-trigger">Part III: New Relic Configuration(The Trigger)</h2>
<h3 id="1-configure-the-destination">1. Configure the Destination</h3>
<ol>
  <li>In New Relic, go to <b>Alerts &amp; AI &gt; Destinations</b>.</li>
  <li>Select <b> Webhook </b>.
    <ul>
      <li><b>Endpoint URL:</b> Your ServiceNow Scripted REST API URL from above.</li>
      <li><b>Authorization Type:</b> Select <b>Basic Authentication</b>. Use your PDI <code class="language-plaintext highlighter-rouge">admin</code> username and password.</li>
    </ul>
  </li>
  <li>Name it ‚ÄúServiceNow PDI‚Äù.
    <h3 id="2-configure-the-workflow-payload">2. Configure the Workflow (Payload)</h3>
  </li>
  <li>Go to <b> Alerts &amp; AI &gt; Workflows </b>.</li>
  <li>Click <b> Add Workflow </b>.
    <ul>
      <li><b>Filter:</b> <code class="language-plaintext highlighter-rouge">Policy Name = 'Low CPU Test'</code> ( we will create policy in the next step)</li>
    </ul>
  </li>
  <li><b>Notify:</b> Select your ‚ÄúServiceNow PDI‚Äù destination.</li>
  <li><b>Payload Template:</b> This defines exactly what data is sent to script. Paste this JSON:
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"issue_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
     </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
     </span><span class="nl">"current_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
     </span><span class="nl">"cpu_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N/A"</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <h3 id="3-create-the-alert-policy">3. Create the Alert Policy</h3>
  </li>
  <li>Go to <b>Alerts &amp; AI &gt; Conditions (Policies) </b>.</li>
  <li>Create a New Policy named <code class="language-plaintext highlighter-rouge">Local CPU Test</code>.</li>
  <li><b>Create a Condition:</b>
    <ul>
      <li><b>Product:</b> NRQL</li>
      <li><b>Query:</b>
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">SELECT</span> <span class="n">average</span><span class="p">(</span><span class="n">cpuPercent</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">SystemSample</span> <span class="k">WHERE</span> <span class="nv">`hostname = 'YOUR_HOSTNAME'
</span></code></pre></div>        </div>
      </li>
      <li><b>Threshold:</b> Critical if query returns value <code class="language-plaintext highlighter-rouge">above 5</code> (Low threshold for easy testing) for at least <code class="language-plaintext highlighter-rouge">1 minute</code>.</li>
      <li><b>Advanced Signal Settings:</b> ‚ÄúClose open incidents on signal loss‚Äù -&gt; set to <code class="language-plaintext highlighter-rouge">5 minutes</code>.</li>
    </ul>
  </li>
</ol>

<h2 id="part-iv-execution--testing">Part IV: Execution &amp; Testing</h2>
<h3 id="test-a-unit-test-via-curl-command-line">Test A: Unit Test via cURL (Command Line)</h3>
<p>Verify your serviceNow script works without waiting for New Relic.</p>
<h4 id="1-create-incidentsimulate-alert">1. Create Incident(Simulate Alert)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"https://&lt;YOUR_INSTANCE&gt;.service-now.com/api/&lt;YOUR_SCOPE_ID&gt;/newrelic_handler/incident"</span> <span class="se">\</span>
<span class="nt">--request</span> POST <span class="se">\</span>
<span class="nt">--header</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
<span class="nt">--user</span> <span class="s1">'admin:&lt;YOUR_PASSWORD&gt;'</span> <span class="se">\</span>
<span class="nt">--data</span> <span class="s1">'{
  "issue_id": "TEST12345",
  "title": "Test High CPU Alert",
  "current_state": "ACTIVATED",
  "cpu_value": "95"
}'</span>
</code></pre></div></div>
<p><b><i>Result&lt;/b&gt;: Check ServiceNow incidents table. You should see a new ticket.</i></b></p>

<h4 id="2-resolve-incidentsimulate-recovery">2. Resolve Incident(Simulate Recovery)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"https://&lt;YOUR_INSTANCE&gt;.service-now.com/api/&lt;YOUR_SCOPE_ID&gt;/newrelic_handler/incident"</span> <span class="se">\</span>
<span class="nt">--request</span> POST <span class="se">\</span>
<span class="nt">--header</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
<span class="nt">--user</span> <span class="s1">'admin:&lt;YOUR_PASSWORD&gt;'</span> <span class="se">\</span>
<span class="nt">--data</span> <span class="s1">'{
  "issue_id": "TEST12345",
  "title": "Test High CPU Alert",
  "current_state": "CLOSED",
  "cpu_value": "20"
}'</span>
</code></pre></div></div>
<p><b><i>Result&lt;/b&gt;: The ticket created in step 1 should now be marked as ‚ÄúResolved‚Äù.</i></b></p>

<h3 id="test-b-end-to-end-integration-smoke-test">Test B: End-to-End Integration (‚ÄúSmoke Test‚Äù)</h3>
<p>Now, use the <code class="language-plaintext highlighter-rouge">strees</code> tool to forced a real CPU spike on your local machine.</p>
<ol>
  <li>Install Stress Tool:
    <ul>
      <li>Linux: <code class="language-plaintext highlighter-rouge">sudo apt-get install stress</code></li>
      <li>MacOS: <code class="language-plaintext highlighter-rouge">brew install stress</code></li>
    </ul>
  </li>
  <li>Run Stress:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">stress --cpu 8 --timeout 180</code> (Runs for 3 minutes).</li>
    </ul>
  </li>
  <li>Monitor:
    <ul>
      <li><b>T+0 to T+1 min:</b> New Relic detects high CPU.</li>
      <li><b>T+1 min:</b> New Relic triggers Alert -&gt; Webhook -&gt; <b>ServiceNow creates Incident</b>.</li>
      <li><b>T+3 min:</b> Stress command ends, CPU drops.</li>
      <li><b>T+5 to T+8 min:</b> New Relic closes Alert -&gt; Webhook -&gt; <b>ServiceNow resolves Incident</b>.</li>
    </ul>
  </li>
</ol>

<h2 id="appendix-troubleshooting">Appendix: Troubleshooting</h2>

<table>
  <thead>
    <tr>
      <th>Error</th>
      <th>Cause</th>
      <th>Fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>401 Unauthorized</td>
      <td>Bad credentials</td>
      <td>Check your PDI admin password. Update the Destination in New Relic.</td>
    </tr>
    <tr>
      <td>403 Forbidden</td>
      <td>Scope/ACL</td>
      <td>Ensure the user has the <code class="language-plaintext highlighter-rouge">admin</code> or <code class="language-plaintext highlighter-rouge">rest_service</code> role.</td>
    </tr>
    <tr>
      <td>404 Not Found</td>
      <td>Bad URL</td>
      <td>Check your API ID and Resource Path. Ensure the Resource is set to <code class="language-plaintext highlighter-rouge">POST</code>.</td>
    </tr>
    <tr>
      <td>Duplicate Incidents</td>
      <td>Logic Error</td>
      <td>Verify the <code class="language-plaintext highlighter-rouge">gr.addQuery</code> in the script matches the <code class="language-plaintext highlighter-rouge">issue_id</code> being sent.</td>
    </tr>
  </tbody>
</table>]]></content><author><name></name></author><category term="New Relic" /><category term="SeriveNow" /><category term="New Relic" /><category term="ServiceNow" /><category term="Integration" /><summary type="html"><![CDATA[A comprehensive guide to Integrate New Relic Incidents into ServiceNow.]]></summary></entry><entry><title type="html">üöÄ Building an AI-Powered Stock Trading Bot in Python</title><link href="https://autoshiftops.com/devops/ai/trading/machine%20learning/2025/11/20/Building-ai-agents-using-python-for-stocktrade.html" rel="alternate" type="text/html" title="üöÄ Building an AI-Powered Stock Trading Bot in Python" /><published>2025-11-20T00:00:00+00:00</published><updated>2025-11-20T00:00:00+00:00</updated><id>https://autoshiftops.com/devops/ai/trading/machine%20learning/2025/11/20/Building-ai-agents-using-python-for-stocktrade</id><content type="html" xml:base="https://autoshiftops.com/devops/ai/trading/machine%20learning/2025/11/20/Building-ai-agents-using-python-for-stocktrade.html"><![CDATA[<h3 id="an-autoshiftops-guide-to-ai-agents-backtesting-and-real-world-automation">An AutoShiftOps guide to AI agents, backtesting, and real-world automation</h3>

<hr />

<h2 id="introduction">Introduction</h2>

<p>At <strong>AutoShiftOps</strong>, we don‚Äôt build demos ‚Äî we build systems that survive real-world uncertainty.</p>

<p>AI trading is often presented as a shortcut to profits:</p>

<blockquote>
  <p>‚ÄúTrain a model, predict prices, make money.‚Äù</p>
</blockquote>

<p>That‚Äôs not how markets work.</p>

<p>This post walks through how to <strong>design an AI-powered stock trading bot</strong> using Python, focusing on <strong>engineering discipline, backtesting, and system thinking</strong>, rather than hype.</p>

<p>You‚Äôll also find links to other published versions of this post on <strong>Medium, Substack, Patreon, and DEV.to</strong> at the bottom.</p>

<hr />

<h2 id="what-is-an-ai-trading-agent">What Is an AI Trading Agent?</h2>

<p>An AI trading agent is <strong>not just a model</strong>.</p>

<p>It‚Äôs a system that:</p>

<ul>
  <li>Observes market data</li>
  <li>Generates signals</li>
  <li>Applies trading rules</li>
  <li>Manages risk</li>
  <li>Evaluates performance</li>
</ul>

<p>Remove any one of these pieces, and the system breaks.</p>

<hr />

<h2 id="autoshiftops-trading-agent-architecture">AutoShiftOps Trading Agent Architecture</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Market Data
‚Üì
AI Prediction Engine
‚Üì
Strategy &amp; Risk Rules
‚Üì
Backtesting Engine
‚Üì
Broker Execution Layer
</code></pre></div></div>

<p>This separation keeps the system testable, explainable, and production-ready.</p>

<hr />

<h2 id="step-1-market-data">Step 1: Market Data</h2>

<p>We start with <strong>historical stock prices</strong> (for example, from Yahoo Finance).</p>

<p>Clean, consistent data matters more than fancy indicators at this stage.</p>

<p>Goals:</p>
<ul>
  <li>Stable inputs</li>
  <li>Reproducible experiments</li>
  <li>Minimal noise</li>
</ul>

<hr />

<h2 id="step-2-ai-model-why-lstm">Step 2: AI Model (Why LSTM?)</h2>

<p>Markets are <strong>time-series data</strong>.</p>

<p>LSTM (Long Short-Term Memory) models work well because they:</p>
<ul>
  <li>Capture temporal patterns</li>
  <li>Handle noisy signals better than linear models</li>
</ul>

<p>‚ö†Ô∏è Reminder: The model provides <strong>signals</strong>, not decisions.</p>

<hr />

<h2 id="step-3-prediction-is-not-trading">Step 3: Prediction Is Not Trading</h2>

<p>Prediction alone does not generate profits.</p>

<p>Trading requires:</p>
<ul>
  <li>Rules</li>
  <li>Constraints</li>
  <li>Risk limits</li>
</ul>

<p>At AutoShiftOps, AI output is treated as <strong>input</strong>, not authority.</p>

<hr />

<h2 id="step-4-strategy-rules">Step 4: Strategy Rules</h2>

<p>Example simple rule layer:</p>

<table>
  <thead>
    <tr>
      <th>Condition</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Predicted price &gt; current + 2%</td>
      <td>BUY</td>
    </tr>
    <tr>
      <td>Predicted price &lt; current - 2%</td>
      <td>SELL</td>
    </tr>
    <tr>
      <td>Otherwise</td>
      <td>HOLD</td>
    </tr>
  </tbody>
</table>

<p>Doing nothing is a valid action.<br />
Over-trading kills strategies faster than bad models.</p>

<hr />

<h2 id="step-5-backtesting">Step 5: Backtesting</h2>

<p>Backtesting is <strong>non-negotiable</strong>.</p>

<p>If you skip it:</p>
<ul>
  <li>You are guessing</li>
  <li>You are curve-fitting</li>
  <li>You are gambling</li>
</ul>

<p>Backtesting reveals:</p>
<ul>
  <li>Drawdowns</li>
  <li>Trade frequency</li>
  <li>Capital erosion</li>
  <li>Market regime sensitivity</li>
</ul>

<p>Many ‚Äúgreat‚Äù models fail here ‚Äî and that‚Äôs a good thing.</p>

<hr />

<h2 id="lessons-learned">Lessons Learned</h2>

<ul>
  <li>AI didn‚Äôt make me profitable ‚Äî it made me <strong>disciplined</strong></li>
  <li>Consistency comes from <strong>rules</strong>, not intelligence</li>
  <li>Engineers have an advantage because they think in <strong>systems, failure modes, and feedback loops</strong></li>
  <li>Trading is a <strong>software system problem first</strong>, finance second</li>
</ul>

<hr />

<h2 id="cross-published-versions">Cross-Published Versions</h2>

<p>This post is also available on:</p>

<ul>
  <li><strong>Medium:</strong> <a href="https://medium.com/@sajjasudhakarrao/building-an-ai-powered-stock-trading-bot-in-python-with-backtesting-779ac13cfd9f">Read on Medium</a></li>
  <li><strong>Substack:</strong> <a href="https://sajjas.substack.com/p/building-an-ai-powered-stock-trading">Read on Substack</a></li>
  <li><strong>Patreon:</strong> <a href="https://www.patreon.com/posts/building-ai-bot-147412738?collection=1863952">Read on Patreon</a></li>
  <li><strong>DEV.to:</strong> <a href="https://dev.to/sajjasudhakararao/building-an-ai-powered-stock-trading-bot-in-python-with-backtesting-19f6">Read on DEV</a></li>
</ul>

<hr />

<h2 id="disclaimer">Disclaimer</h2>

<p>This content is for <strong>educational purposes only</strong>.<br />
It is <strong>not financial advice</strong>.</p>

<hr />

<h2 id="about-autoshiftops">About AutoShiftOps</h2>

<p><strong>AutoShiftOps</strong> explores the intersection of:</p>
<ul>
  <li>AI agents</li>
  <li>Automation</li>
  <li>DevOps</li>
  <li>Real-world engineering systems</li>
</ul>

<p>We focus on <strong>practical AI</strong> ‚Äî systems that survive production, not demos.</p>

<hr />]]></content><author><name></name></author><category term="DevOps" /><category term="AI" /><category term="Trading" /><category term="Machine Learning" /><category term="AI agents" /><category term="stock trading" /><category term="Python" /><category term="LSTM" /><category term="backtesting" /><category term="machine learning" /><category term="AutoShiftOps" /><summary type="html"><![CDATA[A comprehensive guide to building AI agents for stock trading using Python, LSTM models, and backtesting.]]></summary></entry><entry><title type="html">üîß The Container Troubleshooting Playbook: OOMs, CPU Spikes, and Network Timeouts</title><link href="https://autoshiftops.com/docker/linux/troubleshooting/2025/07/19/container-troubleshooting-playbook-docker-linux.html" rel="alternate" type="text/html" title="üîß The Container Troubleshooting Playbook: OOMs, CPU Spikes, and Network Timeouts" /><published>2025-07-19T00:00:00+00:00</published><updated>2025-07-19T00:00:00+00:00</updated><id>https://autoshiftops.com/docker/linux/troubleshooting/2025/07/19/container-troubleshooting-playbook-docker-linux</id><content type="html" xml:base="https://autoshiftops.com/docker/linux/troubleshooting/2025/07/19/container-troubleshooting-playbook-docker-linux.html"><![CDATA[<p>When a container fails in production, you don‚Äôt always have time to browse StackOverflow. You need a checklist.</p>

<p>This post is a field guide for the three most common container ‚Äúmurders‚Äù: Memory (OOMKilled), CPU Throttling, and I/O Saturation. We‚Äôll diagnose each using the <code class="language-plaintext highlighter-rouge">docker stats</code> + Linux host tools workflow we established last week.</p>

<h2 id="scenario-1-the-silent-death-oomkilled">Scenario 1: The ‚ÄúSilent‚Äù Death (OOMKilled)</h2>
<p>Symptom: The container restarts randomly. No error logs in the application output because it was killed instantly by the kernel.</p>

<h3 id="1-confirm-it-was-an-oom-kill">1. Confirm it was an OOM Kill</h3>
<p>Docker knows why the container died. Ask it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker inspect &lt;container&gt; <span class="nt">--format</span> <span class="s1">''</span>
<span class="c"># Output: true</span>
</code></pre></div></div>

<p>Or check the specific exit code (137 = 128 + 9 SIGKILL):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker inspect &lt;container&gt; <span class="nt">--format</span> <span class="s1">''</span>
<span class="c"># Output: 137</span>
</code></pre></div></div>

<h3 id="2-find-the-smoking-gun-in-kernel-logs">2. Find the ‚ÄúSmoking Gun‚Äù in Kernel Logs</h3>
<p>If Docker confirms it, see exactly when the kernel snapped. Run this on the host:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dmesg <span class="nt">-T</span> | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"killed process"</span>
</code></pre></div></div>

<p>You‚Äôll see a line like: <code class="language-plaintext highlighter-rouge">Out of memory: Killed process 1234 (node) total-vm:2048kB, anon-rss:1024kB</code>.</p>

<h3 id="3-the-fix">3. The Fix</h3>
<ul>
  <li>
    <p><strong>Immediate:</strong> Bump the memory limit if the host has capacity.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker update <span class="nt">--memory</span> 2g &lt;container&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Root Cause:</strong> Check your application for memory leaks. If it‚Äôs Java, check the heap settings (<code class="language-plaintext highlighter-rouge">-Xmx</code>). If it‚Äôs Node, check the GC behavior.</p>
  </li>
</ul>

<h2 id="scenario-2-the-slow-death-cpu-throttling">Scenario 2: The ‚ÄúSlow‚Äù Death (CPU Throttling)</h2>
<p>Symptom: App is running but incredibly slow. Latency spikes. Health checks time out.
‚Äã</p>
<h3 id="1-check-if-its-throttling">1. Check if it‚Äôs throttling</h3>
<p>Linux cgroups enforce CPU limits by ‚Äúpausing‚Äù your process when it uses its quota. It doesn‚Äôt kill the app; it just freezes it for milliseconds at a time.</p>

<p>Check <code class="language-plaintext highlighter-rouge">docker stats</code> first:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker stats <span class="nt">--no-stream</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">CPU %</code> is consistently near 100% of your configured limit (e.g., if you gave it 0.5 CPUs and it‚Äôs at 50%), you are being throttled.</p>

<h3 id="2-verify-throttling-in-cgroups">2. Verify Throttling in cgroups</h3>
<p>Look at the raw cgroup metrics (works on cgroup v1/v2):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Find the container ID</span>
docker inspect &lt;container&gt; <span class="nt">--format</span> <span class="s1">''</span>

<span class="c"># Check throttle stats (path varies by distro, commonly:)</span>
<span class="nb">cat</span> /sys/fs/cgroup/cpu/docker/&lt;long-id&gt;/cpu.stat
</code></pre></div></div>

<p>Look for <code class="language-plaintext highlighter-rouge">nr_throttled</code> and <code class="language-plaintext highlighter-rouge">throttled_time</code>. If these numbers are rising, your app is gasping for air.
‚Äã</p>
<h3 id="3-the-fix-1">3. The Fix</h3>
<ul>
  <li>
    <p><strong>Remove the limit</strong> temporarily to prove it‚Äôs the bottleneck.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker update <span class="nt">--cpus</span> 0 &lt;container&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Tune requests:</strong> If the app needs that CPU, increase the limit. If it‚Äôs a bug (infinite loop), profile the app.
‚Äã</p>
    <h2 id="scenario-3-the-gridlock-disk-io-saturation">Scenario 3: The ‚ÄúGridlock‚Äù (Disk I/O Saturation)</h2>
    <p>Symptom: The container becomes unresponsive, <code class="language-plaintext highlighter-rouge">docker ps</code> hangs, or logs stop writing.
‚Äã</p>
    <h3 id="1-identify-the-io-hog">1. Identify the I/O Hog</h3>
    <p>Is it the container or the neighbor?</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check host I/O</span>
iostat <span class="nt">-x</span> 1 5
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">%util</code> is &gt;80%, the disk is saturated.</p>

<h3 id="2-blame-the-container">2. Blame the Container</h3>
<p>Use <code class="language-plaintext highlighter-rouge">pidstat</code> (part of <code class="language-plaintext highlighter-rouge">sysstat</code>) to find which process is thrashing the disk:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pidstat <span class="nt">-d</span> 1
</code></pre></div></div>

<p>Look for the PID with high <code class="language-plaintext highlighter-rouge">kB_rd/s</code> or <code class="language-plaintext highlighter-rouge">kB_wr/s</code>. Match that PID back to a container:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker inspect <span class="nt">--format</span> <span class="s1">''</span> &lt;container&gt;
</code></pre></div></div>

<h3 id="3-the-fix-2">3. The Fix</h3>
<ul>
  <li>
    <p><strong>Limit the blast radius:</strong> Set a Block I/O limit on the greedy container so it doesn‚Äôt kill the host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker update <span class="nt">--blkio-weight</span> 100 &lt;container&gt;  <span class="c"># Low priority (default 500)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Move logs:</strong> Ensure your app isn‚Äôt logging debug data to the container‚Äôs JSON log driver (which writes to disk). Use a log shipper or write to <code class="language-plaintext highlighter-rouge">stdout</code> sparingly.
‚Äã</p>
  </li>
</ul>

<h2 id="bonus-network-connectivity-issues">Bonus: Network Connectivity Issues</h2>
<p><strong>Symptom:</strong> ‚ÄúConnection refused‚Äù or timeouts between containers.</p>

<h3 id="1-the-can-i-reach-it-check">1. The ‚ÄúCan I reach it?‚Äù Check</h3>
<p>Don‚Äôt guess. Enter the container‚Äôs namespace:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-it</span> &lt;source-container&gt; sh
<span class="c"># Inside:</span>
ping &lt;target-container-name&gt;
nc <span class="nt">-zv</span> &lt;target-container-name&gt; &lt;port&gt;
</code></pre></div></div>

<h3 id="2-if-dns-fails">2. If DNS fails</h3>
<p>Docker has its own internal DNS. Check <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> inside the container:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /etc/resolv.conf
</code></pre></div></div>

<p>It should point to Docker‚Äôs embedded DNS server (usually <code class="language-plaintext highlighter-rouge">127.0.0.11</code>). If it‚Äôs missing or wrong, check your daemon config.
‚Äã</p>
<h2 id="summary-checklist-copypaste">Summary Checklist (Copy/Paste)</h2>
<p>| Symptom | Check Command | Fix Action |
|‚Äî‚Äî‚Äî|‚Äî‚Äî‚Äî‚Äî‚Äî|‚Äî‚Äî‚Äî‚Äì|
| Random Restarts | <code class="language-plaintext highlighter-rouge">docker inspect &lt;container&gt; --format ''</code> | Increase RAM limit / Fix memory leak |
| Sluggish App | <code class="language-plaintext highlighter-rouge">cat /sys/fs/cgroup/cpu/docker/&lt;id&gt;/cpu.stat</code> (check <code class="language-plaintext highlighter-rouge">nr_throttled</code>) | Increase CPU limit / Profile app |
| Host Unresponsive | <code class="language-plaintext highlighter-rouge">iostat -x 1 5</code> &amp; <code class="language-plaintext highlighter-rouge">pidstat -d 1</code> | Limit Block I/O weight / Reduce logging |
| Network Timeout | <code class="language-plaintext highlighter-rouge">docker exec &lt;container&gt; nc -zv &lt;target&gt; &lt;port&gt;</code> | Check Docker DNS / Verify network aliases |</p>

<h2 id="next-steps">Next Steps</h2>
<p>Now that you can debug containers manually, how do you automate this? Next week, we‚Äôll build a ‚ÄúSelf-Healing‚Äù Bash Script that detects these states and alerts you automatically.</p>]]></content><author><name></name></author><category term="Docker" /><category term="Linux" /><category term="Troubleshooting" /><category term="Docker" /><category term="cgroups" /><category term="namespaces" /><category term="troubleshooting" /><category term="monitoring" /><summary type="html"><![CDATA[When a containerized service is misbehaving, you need fast answers. This playbook walks through practical commands and mental models to quickly identify and mitigate OOMs, CPU spikes, and network timeouts using Docker and Linux tools.]]></summary></entry><entry><title type="html">üìä Docker Monitoring Without a Platform: docker stats + cgroups (DevOps Field Guide)</title><link href="https://autoshiftops.com/docker/linux/sre/observability/2025/07/13/docker-monitoring-without-a-platform-docker-stats-cgroups.html" rel="alternate" type="text/html" title="üìä Docker Monitoring Without a Platform: docker stats + cgroups (DevOps Field Guide)" /><published>2025-07-13T00:00:00+00:00</published><updated>2025-07-13T00:00:00+00:00</updated><id>https://autoshiftops.com/docker/linux/sre/observability/2025/07/13/docker-monitoring-without-a-platform-docker-stats-cgroups</id><content type="html" xml:base="https://autoshiftops.com/docker/linux/sre/observability/2025/07/13/docker-monitoring-without-a-platform-docker-stats-cgroups.html"><![CDATA[<p>When an incident hits a containerized service, you often don‚Äôt need a full observability stack to get traction. You need fast answers: Which container is hot? What resource is saturating? Is it an app problem or a limit problem?</p>

<p>This guide shows a practical monitoring stack you can run from any Docker host:</p>

<ol>
  <li>Docker-level commands (docker stats, docker inspect, docker logs)</li>
  <li>Host Linux tools (ps/top/free/df/iostat/ss/journalctl)</li>
  <li>Kernel primitives: cgroups (resource limits/accounting) and namespaces (isolation)</li>
</ol>

<h2 id="1-start-with-docker-stats-the-fastest-signal">1) Start with docker stats (the fastest signal)</h2>
<p>docker stats streams runtime metrics for containers, including CPU%, memory usage/limit, network I/O, and block I/O.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker stats
</code></pre></div></div>

<p>Common workflows:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker stats <span class="nt">--no-stream</span>          <span class="c"># Snapshot (good for scripts)</span>
docker stats &lt;container_name&gt;     <span class="c"># Focus on one container</span>
</code></pre></div></div>

<p>How to interpret it (in plain language)</p>
<ul>
  <li><strong>CPU%:</strong> who‚Äôs burning compute right now.</li>
  <li><strong>MEM USAGE / LIMIT:</strong> how close you are to the memory ceiling.</li>
  <li><strong>NET I/O:</strong> traffic spikes, retries, or unusual egress.</li>
  <li><strong>BLOCK I/O:</strong> slow disks, chatty logging, or heavy read/write workloads.</li>
</ul>

<h2 id="2-jump-from-container-name--what-is-it">2) Jump from ‚Äúcontainer name‚Äù ‚Üí ‚Äúwhat is it?‚Äù</h2>
<p>Once you identify a hot container, immediately gather identity + configuration.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker ps
docker inspect &lt;container&gt; | less
</code></pre></div></div>

<p>Useful inspect questions:</p>

<ul>
  <li>What image/tag is running?</li>
  <li>What env vars/config are set?</li>
  <li>What ports and volumes are attached?</li>
  <li>Are there memory/CPU limits configured?</li>
</ul>

<h2 id="3-logs-confirm-symptoms-fast">3) Logs: confirm symptoms fast</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker logs <span class="nt">--tail</span> 200 &lt;container&gt;
docker logs <span class="nt">-f</span> &lt;container&gt;
</code></pre></div></div>

<p>This is often enough to spot:</p>

<ul>
  <li>crash loops</li>
  <li>OOM errors / memory pressure</li>
  <li>upstream timeouts</li>
  <li>DB connection exhaustion</li>
</ul>

<h2 id="4-understand-why-its-happening-cgroups--namespaces-the-mental-model">4) Understand why it‚Äôs happening: cgroups + namespaces (the mental model)</h2>
<p>Docker relies on Linux kernel features:</p>

<ul>
  <li>Namespaces isolate views of processes, networking, mounts, etc.</li>
  <li>cgroups control and account for resources like CPU, memory, and I/O.</li>
</ul>

<p>Why this matters during incidents:</p>

<ul>
  <li>A container can be ‚Äúslow‚Äù because it‚Äôs CPU-throttled, not because the app code suddenly got worse.</li>
  <li>A container can restart because it hit its memory limit and the kernel‚Äôs OOM behavior targeted its processes.</li>
</ul>

<h2 id="5-host-level-confirmation-tie-back-to-your-linux-monitoring-toolkit">5) Host-level confirmation (tie back to your Linux monitoring toolkit)</h2>
<p>When docker stats shows a spike, verify on the host to avoid false conclusions.</p>

<h3 id="cpu-hogs">CPU hogs</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps aux <span class="nt">--sort</span><span class="o">=</span>-%cpu | <span class="nb">head</span> <span class="nt">-15</span>
</code></pre></div></div>

<h3 id="memory-pressure">Memory pressure</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>free <span class="nt">-h</span>
</code></pre></div></div>

<h3 id="disk-full--log-explosions">Disk full / log explosions</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> <span class="nt">-h</span>
<span class="nb">du</span> <span class="nt">-sh</span> /var/lib/docker/<span class="k">*</span> 2&gt;/dev/null | <span class="nb">sort</span> <span class="nt">-h</span> | <span class="nb">tail</span> <span class="nt">-10</span>
</code></pre></div></div>

<h3 id="disk-io-saturation">Disk I/O saturation</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iostat <span class="nt">-x</span> 1 3
</code></pre></div></div>

<h3 id="unexpected-listeners--traffic-patterns">Unexpected listeners / traffic patterns</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ss <span class="nt">-tuln</span>
</code></pre></div></div>

<p>These host checks help you decide whether you‚Äôre dealing with a single container or a node-wide saturation problem.
‚Äã</p>
<h2 id="6-what-to-do-with-the-data-action-mapping">6) What to do with the data (action mapping)</h2>
<p>Use the shortest safe path to stability:</p>

<ul>
  <li>
    <p>CPU high + latency rising</p>

    <ul>
      <li>If CPU is legitimately needed: scale out / add capacity.</li>
      <li>If CPU is throttled: revisit limits/requests (or container CPU shares).</li>
    </ul>
  </li>
  <li>
    <p>Memory near limit</p>

    <ul>
      <li>If memory leak suspected: restart as mitigation + open an issue with heap profiling.</li>
      <li>If limit too low for normal peaks: adjust limit carefully and monitor.</li>
    </ul>
  </li>
  <li>
    <p>Block I/O high</p>

    <ul>
      <li>Check log volume and disk saturation; reduce noisy logs or move logs off disk.</li>
      <li>Consider storage performance constraints and workload patterns.</li>
    </ul>
  </li>
  <li>
    <p>Network I/O abnormal</p>

    <ul>
      <li>Look for retries, timeouts, DDoS/abuse patterns, or upstream issues.</li>
    </ul>
  </li>
</ul>

<h2 id="7-copypaste-triage-sequence-5-minutes">7) Copy/paste triage sequence (5 minutes)</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1) Find the hot container</span>
docker stats <span class="nt">--no-stream</span>

<span class="c"># 2) Identify it</span>
docker ps
docker inspect &lt;container&gt; | less

<span class="c"># 3) Check symptoms</span>
docker logs <span class="nt">--tail</span> 200 &lt;container&gt;

<span class="c"># 4) Confirm on host (avoid guessing)</span>
ps aux <span class="nt">--sort</span><span class="o">=</span>-%cpu | <span class="nb">head</span> <span class="nt">-10</span>
free <span class="nt">-h</span>
<span class="nb">df</span> <span class="nt">-h</span>
iostat <span class="nt">-x</span> 1 3
ss <span class="nt">-tuln</span>
</code></pre></div></div>

<h2 id="next-in-the-series">Next in the series</h2>
<p><b>Next post:</b> Container Troubleshooting Playbook (common symptoms ‚Üí commands ‚Üí safe mitigations ‚Üí root cause follow-ups).</p>]]></content><author><name></name></author><category term="Docker" /><category term="Linux" /><category term="SRE" /><category term="Observability" /><category term="Automation" /><category term="SRE" /><category term="Bash" /><category term="Linux" /><category term="Docker" /><category term="AutoShiftOps" /><summary type="html"><![CDATA[Learn container monitoring from the terminal: docker stats, docker inspect, logs, and how cgroups/namespaces explain CPU/memory/I/O behavior.]]></summary></entry><entry><title type="html">üîß Incident Response Runbook Template for DevOps (Alert ‚Üí Mitigation ‚Üí Comms)</title><link href="https://autoshiftops.com/automation/linux/bash/incident/2025/07/12/incident-response-runbook-template-devops.html" rel="alternate" type="text/html" title="üîß Incident Response Runbook Template for DevOps (Alert ‚Üí Mitigation ‚Üí Comms)" /><published>2025-07-12T00:00:00+00:00</published><updated>2025-07-12T00:00:00+00:00</updated><id>https://autoshiftops.com/automation/linux/bash/incident/2025/07/12/incident-response-runbook-template-devops</id><content type="html" xml:base="https://autoshiftops.com/automation/linux/bash/incident/2025/07/12/incident-response-runbook-template-devops.html"><![CDATA[<h2 id="incident-response-runbook-template-for-devops">Incident Response Runbook Template for DevOps</h2>
<p>Incidents are stressful when the team is improvising. A simple runbook reduces MTTR by making response repeatable, not heroic.
‚Äã
This post provides a ready to use incident response runbook template plus a practical Linux triage checklist you can run from any box.</p>

<h2 id="what-this-runbook-optimizes-for">What this runbook optimizes for</h2>
<ul>
  <li>Fast acknowledgement and clear ownership (Incident Commander + roles).</li>
  <li>Early impact assessment and severity assignment to avoid under/over‚Äëreacting.</li>
  <li>Communication cadence and ‚Äúknown/unknown/next update‚Äù structure that builds trust.</li>
  <li>Evidence capture (commands + logs) to support post‚Äëincident review.</li>
</ul>

<h2 id="the-incident-runbook-template">The incident runbook template</h2>
<p>Copy this into your internal wiki, README, Notion, or ops repo.
‚Äã</p>
<ol>
  <li>
    <p>Trigger</p>

    <p><b>Triggers:</b></p>
    <ul>
      <li>Monitoring alert / SLO breach</li>
      <li>Customer report escalated</li>
      <li>Internal detection (logs, latency spikes, error spikes)</li>
    </ul>
  </li>
  <li>Acknowledge (0‚Äì5 minutes)
    <ul>
      <li>Acknowledge page/alert in your paging system.</li>
      <li>Create an incident channel: #inc-YYYYMMDD-service-shortdesc.</li>
      <li>Assign Incident Commander (IC) and Comms Lead.</li>
      <li>Start an incident document: timeline + links + decisions.
‚Äã</li>
    </ul>
  </li>
  <li>
    <p>Assess severity (5‚Äì10 minutes)</p>

    <p><b>Answer quickly:</b></p>
    <ul>
      <li>What‚Äôs impacted (service, region, feature)?</li>
      <li>How many users / revenue / compliance impact?</li>
      <li>Is impact ongoing and spreading?</li>
    </ul>

    <p><b>Suggested severity:</b></p>
    <ul>
      <li>SEV1: Major outage / severe user impact; immediate coordination.</li>
      <li>SEV2: Partial outage / significant degradation; urgent but controlled.</li>
      <li>SEV3: Minor impact; can be handled async.</li>
    </ul>
  </li>
  <li>
    <p>Stabilize first (10‚Äì30 minutes)</p>

    <p><b>Goal:</b> stop the bleeding before chasing root cause.</p>

    <p><b>Typical mitigations:</b></p>

    <ul>
      <li>Roll back the last deploy/config change.</li>
      <li>Disable a feature flag.</li>
      <li>Scale up/out temporarily.</li>
      <li>Fail over if safe.</li>
      <li>Rate-limit or block abusive traffic.</li>
    </ul>
  </li>
  <li>
    <p>Triage checklist (host-level)
 Run these to establish the baseline quickly (copy/paste friendly).</p>

    <p><b>CPU</b></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ps aux <span class="nt">--sort</span><span class="o">=</span>-%cpu | <span class="nb">head</span> <span class="nt">-15</span>
</code></pre></div>    </div>
    <p><b>Alert cue:</b> any process &gt;50% sustained.</p>

    <p><b>Memory</b></p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> free <span class="nt">-h</span>
</code></pre></div>    </div>

    <p><b>Alert cue:</b> available &lt;20% total RAM.</p>

    <p><b>Disk</b></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">df</span> <span class="nt">-h</span>
 <span class="nb">du</span> <span class="nt">-sh</span> /var/log/<span class="k">*</span> 2&gt;/dev/null | <span class="nb">sort</span> <span class="nt">-h</span> | <span class="nb">tail</span> <span class="nt">-10</span>
</code></pre></div>    </div>
    <p><b>Alert cue:</b> any filesystem &gt;90%.
 ‚Äã</p>

    <p><b>Disk I/O</b></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> iostat <span class="nt">-x</span> 1 3
</code></pre></div>    </div>
    <p><b>Alert cue:</b> %util &gt;80%, await &gt;20ms.</p>

    <p><b>Network listeners</b></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ss <span class="nt">-tuln</span>
</code></pre></div>    </div>
    <p><b>Alert cue:</b> unexpected listeners/ports.
 ‚Äã
 <b>Logs (example: nginx)</b></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> journalctl <span class="nt">-u</span> nginx <span class="nt">-f</span>
</code></pre></div>    </div>
    <p><b>Alert cue:</b> 5xx errors spiking.</p>
  </li>
  <li>
    <p>Comms cadence (keep it boring)<br /></p>

    <p>SEV1: updates every 10‚Äì15 minutes.‚Äã<br />
 SEV2: updates every 30 minutes.<br />
 SEV3: async updates acceptable.<br />
 <br />‚Äã
 Use this structure:</p>
    <ul>
      <li>What we know</li>
      <li>What we don‚Äôt know</li>
      <li>What we‚Äôre doing now</li>
      <li>Next update at: TIME
‚Äã</li>
    </ul>
  </li>
  <li>Verify resolution
    <ul>
      <li>Confirm user impact is gone (synthetic checks + error rate + latency).</li>
      <li>Confirm saturation is back to normal (CPU/memory/disk/I/O).</li>
      <li>Watch for 30‚Äì60 minutes for regression.</li>
    </ul>
  </li>
  <li>Close and learn (post-incident)
    <ul>
      <li>Write a brief timeline (detection ‚Üí mitigation ‚Üí resolution).</li>
      <li>Capture what worked, what didn‚Äôt, and what to automate.</li>
      <li>Create follow-ups: alerts tuning, runbook updates, tests, guardrails.</li>
    </ul>
  </li>
</ol>

<h2 id="bonus-golden-signals-lens-for-incidents">Bonus: ‚ÄúGolden signals‚Äù lens for incidents</h2>
<p>When you‚Äôre lost, anchor on the four golden signals:</p>

<ul>
  <li>Latency (are requests slower?)</li>
  <li>Traffic (is demand abnormal?)</li>
  <li>Errors (is failure rate rising?)</li>
  <li>Saturation (are resources hitting limits?)</li>
</ul>

<p>This keeps triage focused on user impact and system limits, not vanity metrics.
‚Äã</p>

<h2 id="download--reuse">Download / reuse</h2>
<p>If you reuse this template internally, make one improvement immediately: add links to dashboards, logs, deploy history, and owners for each service. Your future self will thank you.</p>]]></content><author><name></name></author><category term="Automation" /><category term="Linux" /><category term="Bash" /><category term="Incident" /><category term="Automation" /><category term="Scripting" /><category term="Bash" /><category term="Linux" /><category term="Incident" /><category term="AutoShiftOps" /><summary type="html"><![CDATA[A ready to use incident response runbook template with severity levels, comms cadence, and Linux triage commands to reduce MTTR.]]></summary></entry><entry><title type="html">üìä Linux Monitoring &amp;amp; Alerting: Command-Line Mastery for DevOps</title><link href="https://autoshiftops.com/automation/linux/bash/2025/07/06/Linux-Monitoring-and-Alerting.html" rel="alternate" type="text/html" title="üìä Linux Monitoring &amp;amp; Alerting: Command-Line Mastery for DevOps" /><published>2025-07-06T00:00:00+00:00</published><updated>2025-07-06T00:00:00+00:00</updated><id>https://autoshiftops.com/automation/linux/bash/2025/07/06/Linux-Monitoring-and-Alerting</id><content type="html" xml:base="https://autoshiftops.com/automation/linux/bash/2025/07/06/Linux-Monitoring-and-Alerting.html"><![CDATA[<h2 id="the-monitoring-gap-every-devops-engineer-faces">The Monitoring Gap Every DevOps Engineer Faces</h2>

<p>Full monitoring stacks like Prometheus + Grafana are great, but they take time to set up. What about the servers you inherit? The staging environments? The emergency VM you spin up during an outage?</p>

<p>Command-line monitoring is your immediate, universal answer. These tools work on every Linux box, no agents required. Better yet, they‚Äôre fast enough to script into alerting workflows.</p>

<p>This post covers the essential Linux monitoring commands plus patterns to turn raw metrics into actionable alerts‚Äîperfect follow-up to our Bash scripting guide.</p>

<h2 id="1-real-time-resource-dashboards">1. Real-Time Resource Dashboards</h2>
<p>The <code class="language-plaintext highlighter-rouge">top</code>/<code class="language-plaintext highlighter-rouge">htop</code> Foundation
<code class="language-plaintext highlighter-rouge">top</code> gives you an instant system snapshot:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>top - 11:26:45 up 5 days,  3:12,  2 <span class="nb">users</span>,  load average: 1.23, 1.45, 1.67
Tasks: 234 total,   2 running, 232 sleeping,   0 stopped,   0 zombie
%Cpu<span class="o">(</span>s<span class="o">)</span>: 12.3 us,  8.7 sy,  0.0 ni, 78.9 <span class="nb">id</span>,  0.1 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :  7900.2 total,  1234.5 free,  4567.8 used,  2097.9 buff/cache
</code></pre></div></div>
<p><b>Pro move:</b> <code class="language-plaintext highlighter-rouge">htop</code> (install with <code class="language-plaintext highlighter-rouge">apt install htop</code>)</p>

<ul>
  <li>
    <p>Mouse/keyboard navigation</p>
  </li>
  <li>
    <p>Color-coded resource bars</p>
  </li>
  <li>
    <p>Tree view of processes (<code class="language-plaintext highlighter-rouge">F5</code>)</p>
  </li>
</ul>

<p>Quick filters:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>htop <span class="nt">-p</span> <span class="si">$(</span>pgrep <span class="nt">-d</span>, nginx<span class="si">)</span>  <span class="c"># Monitor nginx processes only</span>
</code></pre></div></div>

<p><b>Memory Deep Dive:</b> <code class="language-plaintext highlighter-rouge">free -h</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>free <span class="nt">-h</span>
               total        used        free      shared  buff/cache   available
Mem:           7.7Gi       4.2Gi       1.2Gi       128Mi       2.3Gi       3.1Gi 
Swap:          2.0Gi          0B       2.0Gi
</code></pre></div></div>

<p>What matters: Focus on <code class="language-plaintext highlighter-rouge">available</code> column, not <code class="language-plaintext highlighter-rouge">free</code>. Linux aggressively caches to disk.</p>

<h2 id="2-cpu-analysis-whos-eating-cycles">2. CPU Analysis: Who‚Äôs Eating Cycles?</h2>
<p><b>Per-Process Breakdown</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps aux <span class="nt">--sort</span><span class="o">=</span>-%cpu | <span class="nb">head</span> <span class="nt">-10</span>
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
mysql     1234 45.2 12.3 2.1g  980m ?        S    10:00   3:45 /usr/sbin/mysqld
</code></pre></div></div>

<p><b>Historical CPU Trends:</b> <code class="language-plaintext highlighter-rouge">sar</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install: apt install sysstat</span>
sar <span class="nt">-u</span> 1 5     <span class="c"># CPU every 1 sec, 5 samples</span>
sar <span class="nt">-u</span> <span class="nt">-f</span> /var/log/sysstat/sa08  <span class="c"># Yesterday's data</span>

Average: CPU %user %nice %system %iowait %steal %idle
Average:    all  12.34  0.00  8.76    1.23   0.00  77.67
</code></pre></div></div>

<p><b>Alert pattern:</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="k">if </span>sar <span class="nt">-u</span> 1 3 | <span class="nb">tail</span> <span class="nt">-1</span> | <span class="nb">awk</span> <span class="s1">'{if($8 &lt; 70) exit 1}'</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"CPU idle &lt;70% for 3s - investigate!"</span>
<span class="k">fi</span>
</code></pre></div></div>

<h2 id="3-disk-io-the-silent-killer">3. Disk I/O: The Silent Killer</h2>
<p><b>Current I/O:</b> <code class="language-plaintext highlighter-rouge">iostat</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iostat <span class="nt">-x</span> 1 5
Device            r/s     w/s     rkB/s    wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz svctm  %util
sda              23.4     1.2   234.5    12.3     0.0     10.2   0.00  89.12    0.1    2.3   0.45    10.0     6.2  1.23  45.2
</code></pre></div></div>

<p><b>Red flags:</b> <code class="language-plaintext highlighter-rouge">%util &gt;80%</code>, <code class="language-plaintext highlighter-rouge">await &gt;20ms</code></p>

<p><b>Disk Space Alerts:</b> <code class="language-plaintext highlighter-rouge">df</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> <span class="nt">-h</span> <span class="nt">--output</span><span class="o">=</span><span class="nb">source</span>,fstype,size,used,avail,pcent,target | <span class="nb">grep</span> <span class="nt">-v</span> tmpfs
</code></pre></div></div>

<p><b>Scriptable alert:</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> <span class="nt">-h</span> | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s2">"[8-9][0-9]%|[9][0-9]%|[100]%"</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"Disk healthy"</span>
</code></pre></div></div>

<h2 id="4-network-troubleshooting-masters">4. Network Troubleshooting Masters</h2>
<p><b>Active Connections:</b> <code class="language-plaintext highlighter-rouge">ss</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Replace netstat everywhere</span>
ss <span class="nt">-tuln</span>          <span class="c"># Listening TCP/UDP</span>
ss <span class="nt">-tunap</span> | <span class="nb">grep</span> :80   <span class="c"># Processes on port 80</span>
ss <span class="nt">-t</span> state established | <span class="nb">grep</span> :443 | <span class="nb">wc</span> <span class="nt">-l</span>  <span class="c"># Active HTTPS connections</span>
</code></pre></div></div>

<p><b>Drop Counters:</b> <code class="language-plaintext highlighter-rouge">netstat</code> or <code class="language-plaintext highlighter-rouge">ss</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat <span class="nt">-s</span> | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s2">"errors|dropped|retrans"</span>
Ip:
    1234 total packets received
    56 dropped because of memory problems
</code></pre></div></div>

<p><b>Live Packet Capture:</b> <code class="language-plaintext highlighter-rouge">tcpdump</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Capture 100 packets on interface eth0, port 80</span>
<span class="nb">sudo </span>tcpdump <span class="nt">-i</span> eth0 <span class="nt">-c</span> 100 port 80 <span class="nt">-w</span> capture.pcap

<span class="c"># Read capture</span>
tcpdump <span class="nt">-r</span> capture.pcap <span class="nt">-nn</span>
</code></pre></div></div>

<h2 id="5-log-monitoring-beyond-tail--f">5. Log Monitoring: Beyond tail -f</h2>
<p><b>Service Logs:</b> <code class="language-plaintext highlighter-rouge">journalctl</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>journalctl <span class="nt">-u</span> nginx <span class="nt">-f</span>           <span class="c"># Follow nginx logs</span>
journalctl <span class="nt">-u</span> nginx <span class="nt">--since</span> <span class="s2">"1h ago"</span>  <span class="c"># Last hour</span>
journalctl <span class="nt">-p</span> err <span class="nt">-u</span> nginx      <span class="c"># Only errors</span>
journalctl <span class="nt">--no-pager</span> | <span class="nb">grep</span> <span class="nt">-i</span> panic  <span class="c"># System panics</span>
</code></pre></div></div>

<p><b>Pattern Mining:</b> <code class="language-plaintext highlighter-rouge">grep + awk</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Count 5xx errors per minute</span>
journalctl <span class="nt">-u</span> nginx <span class="nt">--since</span> <span class="s2">"10min ago"</span> | <span class="se">\</span>
<span class="nb">grep</span> <span class="s2">" 500 "</span> | <span class="se">\</span>
<span class="nb">awk</span> <span class="s1">'{print $1, $2}'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="nb">.</span> <span class="nt">-f1</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span>

<span class="c"># Slow requests (&gt;2s)</span>
<span class="nb">awk</span> <span class="s1">'$NF &gt; 2 {print}'</span> /var/log/nginx/access.log
</code></pre></div></div>

<h2 id="6-production-alerting-patterns">6. Production Alerting Patterns</h2>
<p><b>CPU/Memory Watchdog</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

alert<span class="o">()</span> <span class="o">{</span> curl <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s2">"CPU </span><span class="k">${</span><span class="nv">CPU</span><span class="k">}</span><span class="s2">%, MEM </span><span class="k">${</span><span class="nv">MEM</span><span class="k">}</span><span class="s2">%"</span> <span class="s2">"</span><span class="nv">$SLACK_WEBHOOK</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>

<span class="nv">CPU</span><span class="o">=</span><span class="si">$(</span>top <span class="nt">-bn1</span> | <span class="nb">grep</span> <span class="s2">"Cpu(s)"</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'%'</span> <span class="nt">-f1</span><span class="si">)</span>
<span class="nv">MEM</span><span class="o">=</span><span class="si">$(</span>free | <span class="nb">awk</span> <span class="s1">'/Mem:/ {printf "%.0f", $3/$2 * 100}'</span><span class="si">)</span>

<span class="o">[[</span> <span class="s2">"</span><span class="nv">$CPU</span><span class="s2">"</span> <span class="nt">-gt</span> 80 <span class="o">||</span> <span class="s2">"</span><span class="nv">$MEM</span><span class="s2">"</span> <span class="nt">-gt</span> 80 <span class="o">]]</span> <span class="o">&amp;&amp;</span> alert
</code></pre></div></div>

<p><b>Disk Space Guardian</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="k">for </span>fs <span class="k">in</span> <span class="si">$(</span><span class="nb">df</span> <span class="nt">--local</span> <span class="nt">--output</span><span class="o">=</span><span class="nb">source</span> | <span class="nb">tail</span> <span class="nt">-n</span> +2<span class="si">)</span><span class="p">;</span> <span class="k">do
  </span><span class="nv">usage</span><span class="o">=</span><span class="si">$(</span><span class="nb">df</span> <span class="nv">$fs</span> | <span class="nb">tail</span> <span class="nt">-1</span> | <span class="nb">awk</span> <span class="s1">'{print $5}'</span> | <span class="nb">sed</span> <span class="s1">'s/%//'</span><span class="si">)</span>
  <span class="o">[[</span> <span class="nv">$usage</span> <span class="nt">-gt</span> 85 <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"ALERT: </span><span class="nv">$fs</span><span class="s2"> at </span><span class="k">${</span><span class="nv">usage</span><span class="k">}</span><span class="s2">%"</span>
<span class="k">done</span>
</code></pre></div></div>

<p><b>Cron schedule:</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Every 5 minutes</span>
<span class="k">*</span>/5 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /usr/local/bin/check_resources.sh
</code></pre></div></div>

<h2 id="7-one-line-dashboards">7. One-Line Dashboards</h2>
<p><b>Combine tools into instant observability:</b></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># System overview (alias this to 'sys')</span>
watch <span class="nt">-n</span> 2 <span class="s1">'printf "\nCPU: "; sar -u 1 1 |tail-1; printf "MEM: "; free -h |tail-1; printf "DISK: "; df -h / /var |tail -2'</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Top resource hogs</span>
watch <span class="nt">-n</span> 2 <span class="s1">'ps aux --sort=-%cpu | head -8; echo "---"; ps aux --sort=-%mem | head -8'</span>
</code></pre></div></div>

<h2 id="quick-reference-table">Quick Reference Table</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| Scenario    | Command                | Pro Tip                              |
| ----------- | ---------------------- | ------------------------------------ |
| CPU trends  | sar -u 1 5             | Historical data in /var/log/sysstat/ |
| Memory      | free -h                | Watch available, ignore free         |
| Disk I/O    | iostat -x 1            | %util &gt;80% = trouble                 |
| Connections | ss -tuln               | Modern netstat replacement           |
| Logs        | journalctl -u nginx -f | systemd's tail -f                    |
| Processes   | htop -p $(pgrep nginx) | Filter to specific app               |
</code></pre></div></div>]]></content><author><name></name></author><category term="Automation" /><category term="Linux" /><category term="Bash" /><category term="Automation" /><category term="Scripting" /><category term="Bash" /><category term="Linux" /><category term="AutoShiftOps" /><summary type="html"><![CDATA[A comprehensive guide Linux Monitoring & Alerting.]]></summary></entry><entry><title type="html">üöÄ Advanced Bash Scripting for DevOps Automation</title><link href="https://autoshiftops.com/automation/linux/bash/2025/07/05/Advanced-bash-scripting.html" rel="alternate" type="text/html" title="üöÄ Advanced Bash Scripting for DevOps Automation" /><published>2025-07-05T00:00:00+00:00</published><updated>2025-07-05T00:00:00+00:00</updated><id>https://autoshiftops.com/automation/linux/bash/2025/07/05/Advanced-bash-scripting</id><content type="html" xml:base="https://autoshiftops.com/automation/linux/bash/2025/07/05/Advanced-bash-scripting.html"><![CDATA[<h2 id="why-bash-still-rules-devops">Why Bash Still Rules DevOps?</h2>

<p>Infrastructure as code, containers, and Kubernetes are great, but when you log into a box to fix something right now, Bash is still the fastest tool you have.
‚Äã</p>

<p>This post focuses on practical Bash scripting patterns that automate real DevOps tasks: deployments, health checks, log cleanups, and safety‚Äëfirst operations you can trust in production.
‚Äã</p>

<h2 id="1-bash-scripting-foundations-done-right">1. Bash Scripting Foundations Done Right</h2>
<p>Even experienced engineers skip basics that later cause flaky scripts.</p>

<p>Always start with a shebang and safe defaults:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail
<span class="nv">IFS</span><span class="o">=</span><span class="s1">$'</span><span class="se">\n\t</span><span class="s1">'</span>
</code></pre></div></div>

<ul>
  <li>
    <p><b>et -e</b> ‚Üí exit on error</p>
  </li>
  <li>
    <p><b>set -u</b> ‚Üí fail on undefined variables</p>
  </li>
  <li>
    <p><b>set -o pipefail</b> ‚Üí fail if any part of a pipe fails
‚Äã</p>
  </li>
</ul>

<p>Use functions instead of long procedural blobs:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log<span class="o">()</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"[</span><span class="si">$(</span><span class="nb">date</span> +<span class="s1">'%F %T'</span><span class="si">)</span><span class="s2">] </span><span class="nv">$*</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>

die<span class="o">()</span> <span class="o">{</span>
  log <span class="s2">"ERROR: </span><span class="nv">$*</span><span class="s2">"</span>
  <span class="nb">exit </span>1
<span class="o">}</span>
</code></pre></div></div>

<p>These patterns make scripts safer and easier to reuse across services and environments.</p>

<h2 id="2-parameters-flags-and-environments">2. Parameters, Flags, and Environments</h2>
<p>A good DevOps script is configurable without editing the file.</p>

<p>Using Arguments and Defaults</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">staging</span><span class="k">}</span><span class="s2">"</span>   <span class="c"># default to staging</span>

log<span class="o">()</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"[</span><span class="si">$(</span><span class="nb">date</span> +<span class="s1">'%F %T'</span><span class="si">)</span><span class="s2">] [</span><span class="nv">$ENVIRONMENT</span><span class="s2">] </span><span class="nv">$*</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>

log <span class="s2">"Deploying to </span><span class="nv">$ENVIRONMENT</span><span class="s2">"</span>
</code></pre></div></div>

<ul>
  <li>
    <p>${1:-staging} gives you a default while still allowing overrides.</p>
  </li>
  <li>
    <p>This pattern works great for scripts you‚Äôll run from CI/CD pipelines.
‚Äã</p>
  </li>
</ul>

<h3 id="robust-flag-parsing">Robust Flag Parsing</h3>
<p>For more complex tools, use getopts:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">getopts</span> <span class="s2">"e:v:h"</span> opt<span class="p">;</span> <span class="k">do
  case</span> <span class="s2">"</span><span class="nv">$opt</span><span class="s2">"</span> <span class="k">in
    </span>e<span class="p">)</span> <span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span> <span class="p">;;</span>
    v<span class="p">)</span> <span class="nv">VERSION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OPTARG</span><span class="s2">"</span> <span class="p">;;</span>
    h<span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Usage: deploy.sh -e &lt;env&gt; -v &lt;version&gt;"</span><span class="p">;</span> <span class="nb">exit </span>0 <span class="p">;;</span>
    <span class="k">*</span><span class="p">)</span> <span class="nb">exit </span>1 <span class="p">;;</span>
  <span class="k">esac</span>
<span class="k">done</span>
</code></pre></div></div>

<p>This turns a script into a proper CLI your team can rely on.‚Äã</p>

<h2 id="3-realworld-deployment-script-pattern">3. Real‚ÄëWorld Deployment Script Pattern</h2>
<p>Here‚Äôs a simplified multi‚Äëstep deployment flow you can adapt for web apps or microservices.
‚Äã</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">staging</span><span class="k">}</span><span class="s2">"</span>
<span class="nv">APP_DIR</span><span class="o">=</span><span class="s2">"/srv/myapp"</span>
<span class="nv">REPO_URL</span><span class="o">=</span><span class="s2">"git@github.com:org/myapp.git"</span>

log<span class="o">()</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"[</span><span class="si">$(</span><span class="nb">date</span> +<span class="s1">'%F %T'</span><span class="si">)</span><span class="s2">] [</span><span class="nv">$ENVIRONMENT</span><span class="s2">] </span><span class="nv">$*</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>

deploy<span class="o">()</span> <span class="o">{</span>
  log <span class="s2">"Updating code..."</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nt">-d</span> <span class="s2">"</span><span class="nv">$APP_DIR</span><span class="s2">/.git"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span>git clone <span class="s2">"</span><span class="nv">$REPO_URL</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$APP_DIR</span><span class="s2">"</span>
  <span class="k">fi
  </span><span class="nb">cd</span> <span class="s2">"</span><span class="nv">$APP_DIR</span><span class="s2">"</span>
  git fetch <span class="nt">--all</span>
  git checkout main
  git pull <span class="nt">--ff-only</span>

  log <span class="s2">"Installing dependencies..."</span>
  npm ci

  log <span class="s2">"Running tests..."</span>
  npm <span class="nb">test

  </span>log <span class="s2">"Building..."</span>
  npm run build

  log <span class="s2">"Restarting service..."</span>
  <span class="nb">sudo </span>systemctl restart myapp

  log <span class="s2">"Deployment complete."</span>
<span class="o">}</span>

deploy
</code></pre></div></div>

<p>Why this works for DevOps:</p>

<ul>
  <li>Idempotent: safe to run multiple times.
‚Äã</li>
  <li>Ties into systemd for consistent service management.</li>
</ul>

<h2 id="4-automated-health-checks-and-rollbacks">4. Automated Health Checks and Rollbacks</h2>
<p>Production automation needs more than ‚Äúdeploy and hope.‚Äù</p>

<p>Health Check Example</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>health_check<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">url</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">http</span>://localhost/health<span class="k">}</span><span class="s2">"</span>
  <span class="k">if </span>curl <span class="nt">-fsS</span> <span class="s2">"</span><span class="nv">$url</span><span class="s2">"</span> <span class="o">&gt;</span> /dev/null<span class="p">;</span> <span class="k">then
    </span>log <span class="s2">"Health check passed for </span><span class="nv">$url</span><span class="s2">"</span>
  <span class="k">else
    </span>die <span class="s2">"Health check FAILED for </span><span class="nv">$url</span><span class="s2">"</span>
  <span class="k">fi</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Combine this with deployment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>previous_version<span class="o">()</span> <span class="o">{</span>
  git describe <span class="nt">--tags</span> <span class="nt">--abbrev</span><span class="o">=</span>0 HEAD~1 2&gt;/dev/null <span class="o">||</span> <span class="nb">echo</span> <span class="s2">""</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rollback<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span>prev
  <span class="nv">prev</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>previous_version<span class="si">)</span><span class="s2">"</span>
  <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$prev</span><span class="s2">"</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> die <span class="s2">"No previous version found for rollback"</span>

  log <span class="s2">"Rolling back to </span><span class="nv">$prev</span><span class="s2">"</span>
  git checkout <span class="s2">"</span><span class="nv">$prev</span><span class="s2">"</span>
  npm run build
  <span class="nb">sudo </span>systemctl restart myapp
<span class="o">}</span>
</code></pre></div></div>

<p>After deployment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deploy
<span class="k">if</span> <span class="o">!</span> health_check <span class="s2">"https://myapp.example.com/health"</span><span class="p">;</span> <span class="k">then
  </span>log <span class="s2">"Health check failed; rolling back"</span>
  rollback
<span class="k">fi</span>
</code></pre></div></div>

<p>This pattern mirrors real‚Äëworld blue/green or canary flows on a smaller scale.
‚Äã</p>
<h2 id="5-log-rotation-and-cleanup-jobs">5. Log Rotation and Cleanup Jobs</h2>
<p>Bash + cron is still a perfectly valid way to manage logs on smaller setups.
‚Äã</p>
<h3 id="rotate-and-compress-logs">Rotate and Compress Logs</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">LOG_DIR</span><span class="o">=</span><span class="s2">"/var/log/myapp"</span>
<span class="nv">DAYS_TO_KEEP</span><span class="o">=</span>7

find <span class="s2">"</span><span class="nv">$LOG_DIR</span><span class="s2">"</span> <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s2">"*.log"</span> <span class="nt">-mtime</span> +<span class="nv">$DAYS_TO_KEEP</span> <span class="nt">-print0</span> <span class="se">\</span>
  | <span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-r</span> <span class="nt">-d</span> <span class="s1">''</span> file<span class="p">;</span> <span class="k">do
      </span><span class="nb">gzip</span> <span class="s2">"</span><span class="nv">$file</span><span class="s2">"</span>
    <span class="k">done</span>
</code></pre></div></div>

<p>Remove Old Archives</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="s2">"</span><span class="nv">$LOG_DIR</span><span class="s2">"</span> <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s2">"*.gz"</span> <span class="nt">-mtime</span> +30 <span class="nt">-delete</span>
</code></pre></div></div>

<p>Schedule with cron:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-e</span>
<span class="c"># Run cleanup daily at 01:30</span>
30 1 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /usr/local/bin/log_cleanup.sh
</code></pre></div></div>

<p>This keeps disks healthy without needing a full log‚Äëmanagement stack.
‚Äã</p>
<h2 id="6-monitoring-scripts-with-alerts">6. Monitoring Scripts with Alerts</h2>
<p>You can wrap common Linux monitoring commands into Bash scripts that push alerts to Slack, email, or webhooks.
‚Äã
Example: CPU and Memory Watchdog</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">CPU_THRESHOLD</span><span class="o">=</span>80
<span class="nv">MEM_THRESHOLD</span><span class="o">=</span>80

cpu_usage<span class="o">()</span> <span class="o">{</span>
  mpstat 1 1 | <span class="nb">awk</span> <span class="s1">'/Average/ &amp;&amp; $12 ~ /[0-9.]+/ {print 100-$12}'</span>
<span class="o">}</span>

mem_usage<span class="o">()</span> <span class="o">{</span>
  free | <span class="nb">awk</span> <span class="s1">'/Mem:/ {printf(\"%.0f\", $3/$2 * 100)}'</span>
<span class="o">}</span>

<span class="nv">CPU</span><span class="o">=</span><span class="si">$(</span>cpu_usage<span class="si">)</span>
<span class="nv">MEM</span><span class="o">=</span><span class="si">$(</span>mem_usage<span class="si">)</span>

<span class="k">if</span> <span class="o">((</span> CPU <span class="o">&gt;</span> CPU_THRESHOLD <span class="o">||</span> MEM <span class="o">&gt;</span> MEM_THRESHOLD <span class="o">))</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"High usage detected: CPU=</span><span class="k">${</span><span class="nv">CPU</span><span class="k">}</span><span class="s2">% MEM=</span><span class="k">${</span><span class="nv">MEM</span><span class="k">}</span><span class="s2">%"</span>
  <span class="c"># Hook: send to Slack / email / alerting system</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>This complements full monitoring stacks by giving you lightweight, scriptable checks.‚Äã</p>

<h2 id="7-safer-file-and-config-changes">7. Safer File and Config Changes</h2>
<p>Use Bash to modify configuration files predictably instead of manual edits.</p>

<p>Backups + Atomic Changes</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CONFIG</span><span class="o">=</span><span class="s2">"/etc/myapp/config.yaml"</span>
<span class="nv">BACKUP</span><span class="o">=</span><span class="s2">"/etc/myapp/config.yaml.</span><span class="si">$(</span><span class="nb">date</span> +<span class="s1">'%F-%H%M%S'</span><span class="si">)</span><span class="s2">.bak"</span>

<span class="nb">cp</span> <span class="s2">"</span><span class="nv">$CONFIG</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$BACKUP</span><span class="s2">"</span>

<span class="c"># Example: toggle a feature flag</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/feature_x: false/feature_x: true/'</span> <span class="s2">"</span><span class="nv">$CONFIG</span><span class="s2">"</span>

systemctl restart myapp
</code></pre></div></div>

<p>Pattern:</p>

<ul>
  <li>
    <p>Always create timestamped backups.</p>
  </li>
  <li>
    <p>Make changes with sed, awk, or yq/jq for structured data.
‚Äã</p>
  </li>
</ul>]]></content><author><name></name></author><category term="Automation" /><category term="Linux" /><category term="Bash" /><category term="Automation" /><category term="Scripting" /><category term="Bash" /><category term="Linux" /><category term="AutoShiftOps" /><summary type="html"><![CDATA[A comprehensive guide for bash scripting commands essential for Devops Automation.]]></summary></entry><entry><title type="html">üö¶ Feature Flag Management in Continuous Delivery</title><link href="https://autoshiftops.com/devops/ci/cd/continuous%20delivery/2025/06/29/Feature-Flag-Management-in-Continuous-Delivery.html" rel="alternate" type="text/html" title="üö¶ Feature Flag Management in Continuous Delivery" /><published>2025-06-29T00:00:00+00:00</published><updated>2025-06-29T00:00:00+00:00</updated><id>https://autoshiftops.com/devops/ci/cd/continuous%20delivery/2025/06/29/Feature%20Flag%20Management%20in%20Continuous%20Delivery</id><content type="html" xml:base="https://autoshiftops.com/devops/ci/cd/continuous%20delivery/2025/06/29/Feature-Flag-Management-in-Continuous-Delivery.html"><![CDATA[<h2 id="feature-flag-management-in-continuous-delivery">Feature Flag Management in Continuous Delivery</h2>

<p>Feature flags (also known as feature toggles) are a <strong>powerful mechanism to decouple code deployment from feature releases</strong>. They enable DevOps teams to <strong>release features gradually, conduct A/B tests, and quickly rollback problematic features</strong> without redeploying code.</p>

<p>This practice improves <strong>release velocity, reduces risk, and provides better control over production deployments</strong>.</p>

<hr />

<h3 id="why-feature-flags-matter">Why Feature Flags Matter</h3>

<ul>
  <li><strong>Controlled Rollouts:</strong> Enable incremental exposure of new features</li>
  <li><strong>A/B Testing:</strong> Experiment with different variants to measure user impact</li>
  <li><strong>Quick Rollbacks:</strong> Turn off problematic features instantly without redeploying</li>
  <li><strong>Decoupled Deployments:</strong> Separate feature release from code integration</li>
  <li><strong>Improved Collaboration:</strong> Developers, product managers, and QA can manage flags independently</li>
</ul>

<hr />

<h3 id="types-of-feature-flags">Types of Feature Flags</h3>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Release Flags</strong></td>
      <td>Control feature release timing in production</td>
    </tr>
    <tr>
      <td><strong>Experiment Flags</strong></td>
      <td>Enable A/B testing and experimentation</td>
    </tr>
    <tr>
      <td><strong>Ops Flags</strong></td>
      <td>Control operational behavior like throttling or debugging</td>
    </tr>
    <tr>
      <td><strong>Permission Flags</strong></td>
      <td>Enable features for specific users or groups</td>
    </tr>
    <tr>
      <td><strong>Kill Switch Flags</strong></td>
      <td>Quickly disable features in case of issues</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="feature-flag-workflow-example">Feature Flag Workflow Example</h3>

<ol>
  <li><strong>Develop Feature Behind Flag:</strong> Wrap new code in a feature flag</li>
  <li><strong>Deploy Code to Production:</strong> Deploy with the feature flag turned OFF</li>
  <li><strong>Enable Gradually:</strong> Activate for internal users or small percentage of users</li>
  <li><strong>Monitor Metrics:</strong> Observe performance, errors, and user behavior</li>
  <li><strong>Roll Out or Roll Back:</strong> Adjust feature exposure based on insights</li>
  <li><strong>Clean Up:</strong> Remove unused flags after feature is fully released</li>
</ol>

<hr />

<h3 id="visual-diagram">Visual Diagram</h3>

<div class="mermaid">
flowchart TD
    A[Feature Development] --&gt; B[Feature Flag Wrapper]
    B --&gt; C[Deploy to Production]
    C --&gt; D[Controlled Activation]
    D --&gt; E[Monitor Metrics &amp; User Feedback]
    E --&gt; F[Full Rollout or Rollback]
</div>

<hr />

<h3 id="sample-code-snippet-python-feature-flag">Sample Code Snippet: Python Feature Flag</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FEATURE_FLAGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">new_checkout_flow</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">beta_search</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">checkout</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">FEATURE_FLAGS</span><span class="p">[</span><span class="sh">"</span><span class="s">new_checkout_flow</span><span class="sh">"</span><span class="p">]:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using new checkout flow</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using legacy checkout flow</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">search</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">FEATURE_FLAGS</span><span class="p">[</span><span class="sh">"</span><span class="s">beta_search</span><span class="sh">"</span><span class="p">]:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using beta search algorithm</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using standard search</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>
    <p>Toggle flags via environment variables, configuration files, or feature flag management tools</p>
  </li>
  <li>
    <p>Avoid hardcoding flags in multiple places</p>
  </li>
</ul>

<hr />

<h3 id="recommended-tools">Recommended Tools</h3>

<table>
  <thead>
    <tr>
      <th>Category</th>
      <th>Tools</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Feature Flag Management</strong></td>
      <td>LaunchDarkly, Unleash, Flagsmith, Split.io</td>
    </tr>
    <tr>
      <td><strong>CI/CD Integration</strong></td>
      <td>GitHub Actions, GitLab CI/CD, Jenkins</td>
    </tr>
    <tr>
      <td><strong>Monitoring &amp; Metrics</strong></td>
      <td>Grafana, Datadog, Prometheus</td>
    </tr>
    <tr>
      <td><strong>Rollback Automation</strong></td>
      <td>Ansible, Python scripts, Kubernetes Operators</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="best-practices">Best Practices</h3>

<ul>
  <li>Keep flags short-lived to prevent code complexity</li>
  <li>Document the purpose and lifecycle of each flag</li>
  <li>Use centralized management for toggles in production</li>
  <li>Automate rollback and monitoring for safety</li>
  <li>Test flags in staging environments before production</li>
</ul>

<hr />

<h3 id="common-pitfalls">Common Pitfalls</h3>

<ul>
  <li>Leaving old flags in code, causing technical debt</li>
  <li>Overusing flags, leading to confusion and maintenance overhead</li>
  <li>Failing to monitor feature impact before full rollout</li>
  <li>Not cleaning up unused flags after feature release</li>
</ul>

<hr />

<h3 id="key-takeaways">Key Takeaways</h3>

<ul>
  <li>Feature flags decouple code deployment from feature release, increasing agility</li>
  <li>Controlled rollouts, A/B testing, and quick rollbacks reduce risk</li>
  <li>Centralized management and automated monitoring improve reliability</li>
  <li>Flags should be short-lived and carefully documented</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>Feature flag management is a critical strategy for modern DevOps and continuous delivery. By using feature flags, teams can release features faster, experiment safely, and maintain stability in production environments. Implementing proper workflows, monitoring, and automated rollback mechanisms ensures a reliable and scalable deployment strategy.</p>]]></content><author><name></name></author><category term="DevOps" /><category term="CI/CD" /><category term="Continuous Delivery" /><category term="feature flags" /><category term="continuous delivery" /><category term="DevOps" /><category term="release management" /><category term="canary releases" /><category term="A/B testing" /><summary type="html"><![CDATA[Learn how to implement feature flag management in CI/CD pipelines to enable controlled rollouts, canary releases, and safer deployments in production.]]></summary></entry></feed>